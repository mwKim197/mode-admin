import{r as $,v as C,a as j,h as G}from"./imageUploader-Bl40Jp5H.js";import{g as H,a as W,d as z}from"./main-BZgyfFOO.js";let w,v;async function X(){const I=h("menuId");if(!I)return;const l=H();if(!l){window.showToast("사용자 정보가 없습니다.",3e3,"warning");return}const N=await(await W(`/model_admin_menu?userId=${l.userId}&menuId=${I}&func=get-menu-by-id`)).json();await $(N),document.getElementById("logoUpload").addEventListener("change",async n=>{await P(n)});const f=document.getElementById("saveDtlBtn");if(f){let n=function(){var t;const e=(t=document.querySelector('input[name="iceYn"]:checked'))==null?void 0:t.value;c&&(c.style.display=e==="no"?"none":"block")},a=function(){var u;const t=((u=document.querySelector('input[name="cupYn"]:checked'))==null?void 0:u.value)==="yes";s&&(s.style.display=t?"none":"block"),r&&(r.style.display=t?"none":"block"),m&&(m.style.display=t?"none":"block")};f.addEventListener("click",async()=>{const e=R(l.userId),t=C(e);if(t){window.showToast(t,3e3,"warning");return}const u=j(e);if(u){window.showToast(u,3e3,"warning");return}const p={...e,...w&&v&&{originalFileName:v,imageBase64:w}};if(confirm("수정사항을 저장하시겠습니까?")){const y={userId:l.userId,updatedData:p};try{if((await z("/model_admin_menu?func=put-update-menu",y)).ok)window.showToast("수정사항 저장완료."),setTimeout(()=>{window.location.href="/html/product.html"},1e3);else{window.showToast("수정사항 저장에 실패하였습니다.",3e3,"error");return}}catch{}}});const i=document.querySelectorAll('input[name="iceYn"]'),c=document.getElementById("ice-water-time-box");i.forEach(e=>{e.addEventListener("change",n)}),n();const o=document.querySelectorAll('input[name="cupYn"]'),s=document.getElementById("items-container"),r=document.getElementById("cup-ice-selection-box"),m=document.getElementById("ice-water-time-box");o.forEach(e=>{e.addEventListener("change",a)}),a()}function h(n){return new URLSearchParams(window.location.search).get(n)}async function P(n){const a=n.target,i=document.getElementById("logoPreview"),c=document.getElementById("fileName");if(!c){window.showToast("에러발생",3e3,"error");return}try{const{base64:o,fileName:s}=await G(a,i,c);w=o,v=s}catch(o){window.showToast(`이미지 업로드 실패: ${o}`,3e3,"warning"),console.warn("이미지 업로드 실패:",o)}}function R(n){var B,E,S,k;const a=Number(h("menuId")||"0"),i=Number(document.getElementById("menu-no").value),c=document.getElementById("menu-name").value,o=document.getElementById("menu-price").value.trim(),s=document.getElementById("menu-category").value,r=((B=document.querySelector('input[name="cupYn"]:checked'))==null?void 0:B.value)||"no",m=((E=document.querySelector('input[name="cup"]:checked'))==null?void 0:E.value)||"",e=((S=document.querySelector('input[name="iceYn"]:checked'))==null?void 0:S.value)||"",t=((k=document.querySelector('input[name="empty"]:checked'))==null?void 0:k.value)||"",u=document.getElementById("ice-time").value.trim(),p=document.getElementById("water-time").value.trim(),y="",g={best:document.getElementById("state-best").value,event:document.getElementById("state-event").value,new:document.getElementById("state-new").value},U=Array.from(document.querySelectorAll(".item")).map((b,A)=>{var q,Y,x,D,F;const T=((q=b.querySelector(".item-type-select"))==null?void 0:q.value)||"",d=b.querySelectorAll("input"),L=String(parseFloat(((Y=d[0])==null?void 0:Y.value)||"0")),V=String(parseFloat(((x=d[1])==null?void 0:x.value)||"0")),_=String(parseFloat(((D=d[2])==null?void 0:D.value)||"0")),M=T==="garucha"?"0":String(parseFloat(((F=d[3])==null?void 0:F.value)||"0"));return{no:String(A+1),type:T,value1:L,value2:V,value3:_,value4:M}});return{userId:n,menuId:a,no:i,name:c,price:o,category:s,cupYn:r,cup:m,empty:t,iceYn:e,iceTime:u,waterTime:p,image:y,state:g,items:U}}}export{X as initProductDetail};
