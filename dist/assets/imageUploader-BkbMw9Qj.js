import{g as $,a as B}from"./main-B1NCi6Rz.js";function E(e){if(e==null||e==="")return null;const t=String(e).trim();return/^\d+$/.test(t)?parseInt(t,10):null}function I(e){if(e==null||e==="")return null;const t=String(e).trim();return/^\d+(\.\d)?$/.test(t)?parseFloat(t):null}function S(e){if(e==null||e==="")return!1;const t=String(e).trim();return/^([1-9]\d*|0)$/.test(t)}function f(e){if(e==null||e==="")return!1;const t=String(e).trim();return/^([1-9]\d*|0)(\.\d)?$/.test(t)}function D(e){var l;const t=E(e.no);if(t===null||t<1||t>300)return"📛 순번은 1부터 300 사이의 정수로 입력해주세요.";if(!((l=e.name)!=null&&l.trim()))return"📛 메뉴 이름을 입력해주세요.";if(!e.category)return"📛 카테고리를 선택해주세요.";const n=e.price;if(!(n!=null&&n.trim())||!S(n))return"📛 가격을 정수로 입력해주세요.";if(e.cupYn==="no"&&!e.cup)return"📛 컵 종류를 선택해주세요.";if(e.cupYn==="no"&&e.iceYn==="yes"&&!f(e.iceTime))return"📛 얼음 시간을 입력해주세요.";const o=I(e.iceTime);if(o==null||o<0||o>10)return"📛 얼음 시간은 0부터 10까지의 소수 첫째 자리까지 입력해주세요.";const c=I(e.waterTime);if(c==null||c<0||c>10)return"📛 물 시간은 0부터 10까지의 소수 첫째 자리까지 입력해주세요.";if(e.cupYn==="no"&&e.items.length>0)for(let a=0;a<e.items.length;a++){const s=e.items[a];if(!s.type)return`📛 ${a+1}번째 재료의 타입을 선택해주세요.`;if(s.type==="coffee"&&!(parseFloat(s.value1)>0||parseFloat(s.value2)>0))return"📛 원두1, 원두2 중 한개의 값은 입력해야합니다.";if(s.type!=="coffee"){if(!f(s.value1))return`📛 ${a+1}번째 재료의 첫 번째 값을 입력해주세요.`;if(!f(s.value2))return`📛 ${a+1}번째 재료의 두 번째 값을 입력해주세요.`}if(!f(s.value3))return`📛 ${a+1}번째 재료의 세 번째 값을 입력해주세요.`;if(s.type!=="garucha"&&!f(s.value4))return`📛 ${a+1}번째 재료의 네 번째 값을 입력해주세요.`}return null}function w(e){for(let t=0;t<e.items.length;t++){const n=e.items[t],o=c=>c>=1&&c<=6&&/^[0-9]+(\.[0-9]{1,2})?$/.test(String(c));if(n.type==="coffee"){if(parseFloat(n.value1)>0){if(parseFloat(n.value2))return"☕ 그라인더1 사용 시, 그라인더2는 0이어야 합니다.";if(!o(n.value1))return"☕ 그라인더1 값은 1~6 초 범위의 소수여야 합니다."}if(parseFloat(n.value2)>0){if(parseFloat(n.value1))return"☕ 그라인더2 사용 시, 그라인더1은 0이어야 합니다.";if(!o(n.value2))return"☕ 그라인더2 값은 1~6 초 범위의 소수여야 합니다."}}if(n.type==="garucha"&&parseFloat(n.value2)>0&&parseFloat(n.value3)<parseFloat(n.value2)*10)return`🍵 가루차 핫워터(${n.value3})는 추출시간(${n.value2})의 10배 이상이어야 합니다.`;if(n.type==="garucha"&&(parseFloat(n.value1)>=7||parseFloat(n.value1)<=0))return"🍵 가루차값은 1~6사이입니다";if(n.type==="syrup"&&parseFloat(n.value3)<20&&parseFloat(n.value4)<20)return"🍯 시럽 핫워터 또는 탄산수 중 하나는 20 이상이어야 합니다.";if(n.type==="syrup"&&(parseFloat(n.value1)>=6||parseFloat(n.value1)<=0))return"🍯 시럽값은 1~5사이입니다"}return null}function g(e,t){var l;const n=(t==null?void 0:t.type)||"",o=document.createElement("div");o.className="boxStyle gr mb20 item",o.innerHTML=`
    <h2 class="mb10">${e+1}항목</h2>
    <p class="fs14">타입</p>
    <div class="btnFlex mb20">
      <select class="popup-select mb0 item-type-select">
        <option value="">선택</option>
        <option value="coffee" ${n==="coffee"?"selected":""}>커피</option>
        <option value="garucha" ${n==="garucha"?"selected":""}>가루차</option>
        <option value="syrup" ${n==="syrup"?"selected":""}>시럽</option>
      </select>
      <button class="btn red delete-btn">삭제</button>
    </div>
    ${F(n,t)}
  `,(l=o.querySelector(".delete-btn"))==null||l.addEventListener("click",()=>o.remove());const c=o.querySelector(".item-type-select");return c.addEventListener("change",()=>{const a=c.value,s=o.parentElement,i=g(e,{type:a});s.replaceChild(i,o)}),k(o),o}function F(e,t={}){return e==="coffee"?`
      <div class="input-group col mb20">
        <div><p class="fs14">원두 1</p><input type="text" value="${t.value1||"0"}" /></div>
        <div><p class="fs14">원두 2</p><input type="text" value="${t.value2||"0"}" /></div>
      </div>
      <div class="input-group col">
        <div><p class="fs14">추출량</p><input type="text" value="${t.value3||"0"}" /></div>
        <div><p class="fs14">온수</p><input type="text" value="${t.value4||"0"}" /></div>
      </div>
    `:e==="garucha"?`
      <div class="input-group col mb20">
        <div><p class="fs14">차 종류</p><input type="text" value="${t.value1||"0"}" /></div>
        <div><p class="fs14">추출 시간</p><input type="text" value="${t.value2||"0"}" /></div>
      </div>
      <div class="input-group col">
        <div><p class="fs14">온수</p><input type="text" value="${t.value3||"0"}" /></div>
        <div></div>
      </div>
    `:e==="syrup"?`
      <div class="input-group col mb20">
        <div><p class="fs14">시럽 종류</p><input type="text" value="${t.value1||"0"}" /></div>
        <div><p class="fs14">펌프 시간</p><input type="text" value="${t.value2||"0"}" /></div>
      </div>
      <div class="input-group col">
        <div><p class="fs14">온수</p><input type="text" value="${t.value3||"0"}" /></div>
        <div><p class="fs14">탄산수</p><input type="text" value="${t.value4||"0"}" /></div>
      </div>
    `:""}function k(e){const t=e.querySelectorAll("input, select");for(const n of t)n.addEventListener("blur",()=>{var u,p,d,r;const o=e,c=o.querySelector(".item-type-select").value,l=o.querySelectorAll("input"),s={items:[{type:c,value1:(u=l[0])==null?void 0:u.value,value2:(p=l[1])==null?void 0:p.value,value3:(d=l[2])==null?void 0:d.value,value4:(r=l[3])==null?void 0:r.value}]},i=w(s);i&&window.showToast(i,2e3,"error")})}const y=document.getElementById("logoPreview"),x="/img/";function T(e,t){const n=e.value;n?(t.src=`${x}${n}.png`,t.style.display="block"):t.style.display="none"}function h(e,t){e.addEventListener("change",()=>{const n=(y==null?void 0:y.src)||"";if(!(n.startsWith("blob:")||n.startsWith("data:")||n.includes("s3.ap-northeast-2.amazonaws.com"))){alert("이미지를 선택해주세요."),e.value="";return}T(e,t)})}const q=document.getElementById("state-new"),L=document.getElementById("state-event"),Y=document.getElementById("state-best"),C=document.getElementById("overlay-new"),A=document.getElementById("overlay-event"),M=document.getElementById("overlay-best");h(q,C);h(L,A);h(Y,M);async function H(e){const t=$();if(!t){alert("사용자 정보가 없습니다.");return}const n=await B(`/model_user_setting?func=get-user&userId=${t.userId}`),{user:o}=await n.json();R(o.category),e&&U(e)}function R(e){const t=document.getElementById("menu-category");t&&(t.innerHTML='<option value="">선택</option>',e.forEach(({name:n,item:o})=>{const c=document.createElement("option");c.value=o,c.textContent=n,t.appendChild(c)}))}function U(e){var i,u,p,d;const t=(i=e.image)==null?void 0:i.split("\\").pop(),n=encodeURIComponent(t??""),o=`https://model-narrow-road.s3.ap-northeast-2.amazonaws.com/model/${e.userId}/${n}`,c=document.getElementById("logoPreview");c&&(c.src=o,c.style.display="block");const l=document.getElementById("fileName");l&&(l.textContent=t),document.getElementById("menu-no").value=String(e.no),document.getElementById("menu-name").value=e.name,document.getElementById("menu-price").value=e.price,document.getElementById("ice-time").value=e.iceTime,document.getElementById("water-time").value=e.waterTime;const a=document.getElementById("barcode-input");a&&e.barcode&&(a.value=e.barcode);const s=document.getElementById("menu-category");s&&(s.value=e.category),document.querySelectorAll('input[name="cup"]').forEach(r=>r.checked=r.value===e.cup),document.querySelectorAll('input[name="iceYn"]').forEach(r=>r.checked=r.value===e.iceYn),document.querySelectorAll('input[name="cupYn"]').forEach(r=>r.checked=r.value===e.cupYn),document.querySelectorAll('input[name="empty"]').forEach(r=>r.checked=r.value===e.empty),document.getElementById("state-new").value=((u=e.state)==null?void 0:u.new)||"",document.getElementById("state-event").value=((p=e.state)==null?void 0:p.event)||"",document.getElementById("state-best").value=((d=e.state)==null?void 0:d.best)||"",setTimeout(()=>{const r=new Event("change"),v=document.querySelector('input[name="cupYn"]:checked');v&&v.dispatchEvent(r);const m=document.querySelector('input[name="iceYn"]:checked');m&&m.dispatchEvent(r)},100),V(e.items),requestAnimationFrame(()=>{var m;const r=document.getElementById("ice-water-time-box"),v=(m=document.querySelector('input[name="iceYn"]:checked'))==null?void 0:m.value;r&&(r.style.display=v==="no"?"none":"block")})}function V(e){const t=document.getElementById("items-container");t.innerHTML="",e.forEach((n,o)=>{const c=g(o,n);t.appendChild(c)})}var b;(b=document.getElementById("addItemBtn"))==null||b.addEventListener("click",()=>{const e=document.getElementById("items-container"),t=e.children.length,n=g(t);e.appendChild(n)});function z(e,t,n,o=600,c=600,l=2*1024*1024){return new Promise((a,s)=>{var d;const i=(d=e.files)==null?void 0:d[0];if(!i)return s("파일이 없습니다.");if(i.size>l)return e.value="",alert(`❌ 파일 크기는 최대 ${l/1024/1024}MB 이하여야 합니다.`),s("파일 용량 초과");const u=new Image,p=URL.createObjectURL(i);u.src=p,u.onload=()=>{if(u.width>o||u.height>c)return e.value="",alert(`❌ 이미지 사이즈는 ${o}x${c} 이하만 가능합니다.`),s("이미지 크기 초과");t.src=p,t.style.display="block",n&&(n.textContent=i.name);const r=new FileReader;r.onload=()=>{const v=r.result,m=v.replace(/^data:image\/[a-zA-Z]+;base64,/,"");t.src=v,t.style.display="block",n&&(n.textContent=i.name),a({base64:m,fileName:i.name,dataUrl:v})},r.onerror=s,r.readAsDataURL(i)},u.onerror=()=>s("이미지 로드 실패")})}export{w as a,z as h,H as r,D as v};
