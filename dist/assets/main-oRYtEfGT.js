const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./point-BqPqUluq.js","./apiHelpers-Cj0oONL2.js","./userStorage-DqYcZspP.js","./product-CfvPoXjY.js","./productDetail-CdGYonxX.js","./productAdd-D9aT_PDN.js","./notice-C-EMZOji.js","./notice-D1Buw7SL.css"])))=>i.map(i=>d[i]);
(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function e(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerPolicy&&(r.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?r.credentials="include":o.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(o){if(o.ep)return;o.ep=!0;const r=e(o);fetch(o.href,r)}})();const y="modulepreload",w=function(n,t){return new URL(n,t).href},p={},c=function(t,e,s){let o=Promise.resolve();if(e&&e.length>0){const a=document.getElementsByTagName("link"),i=document.querySelector("meta[property=csp-nonce]"),f=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));o=Promise.allSettled(e.map(l=>{if(l=w(l,s),l in p)return;p[l]=!0;const d=l.endsWith(".css"),_=d?'[rel="stylesheet"]':"";if(!!s)for(let h=a.length-1;h>=0;h--){const u=a[h];if(u.href===l&&(!d||u.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${l}"]${_}`))return;const m=document.createElement("link");if(m.rel=d?"stylesheet":y,d||(m.as="script"),m.crossOrigin="",m.href=l,f&&m.setAttribute("nonce",f),document.head.appendChild(m),d)return new Promise((h,u)=>{m.addEventListener("load",h),m.addEventListener("error",()=>u(new Error(`Unable to preload CSS for ${l}`)))})}))}function r(a){const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=a,window.dispatchEvent(i),!i.defaultPrevented)throw a}return o.then(a=>{for(const i of a||[])i.status==="rejected"&&r(i.reason);return t().catch(r)})},E="https://api.narrowroad-model.com";async function g(n,t={}){if(window.location.pathname.includes("/html/log.html")||window.location.pathname==="/")return{ok:!1,status:200,json:async()=>({message:"로그인 페이지에서는 인증 요청을 하지 않습니다."})};const s=localStorage.getItem("authToken");if(!s)return console.log("❌ 토큰이 없습니다. 로그인 페이지로 이동합니다."),window.location.href="/index.html",{ok:!1,status:401,json:async()=>({message:"인증 토큰이 없습니다."})};const o={...t,headers:{...t.headers,Authorization:`Bearer ${s}`,"Content-Type":"application/json"}};try{const r=await fetch(`${E}${n}`,o);if(r.status===401||r.status===403){const a=await r.json();return console.error("❌ 인증 실패:",a.message),alert(a.message||"세션이 만료되었습니다. 다시 로그인해주세요."),localStorage.removeItem("authToken"),window.location.href="/index.html",{ok:!1,status:r.status,json:async()=>a}}return r}catch(r){return console.error("❌ API 요청 오류:",r),{ok:!1,status:500,json:async()=>({message:"❌ API 요청 오류"})}}}class v extends Error{}v.prototype.name="InvalidTokenError";async function L(){const n=await g("/model_admin_login?func=me");if(n.status===401||n.status===403){console.warn("🚫 인증 실패 - 로그인 페이지로 이동"),localStorage.removeItem("authToken"),window.location.href="/index.html";return}const t=await n.json();console.log("✅ 사용자 정보:",t);const e=t==null?void 0:t.grade;if(!e){console.warn("❌ 사용자 grade 정보가 없습니다.");return}const s={"/html/01.notice.html":[1,2],"/html/01.notice-edit.html":[1,2],"/html/notice.html":[1,2]},o={1:"/html/dashboard.html",2:"/html/dashboard.html",3:"/html/franchise_dashboard.html",4:"/html/store_dashboard.html"},r=window.location.pathname,a=s[r];a&&!a.includes(e)&&(alert("이 페이지에 접근할 수 있는 권한이 없습니다."),window.location.href=o[e]||"/index.html")}async function P(){const n=await g("/model_admin_login?func=me");if(!n.ok)return console.warn("❌ 사용자 정보를 가져오지 못했습니다."),null;const t=await n.json();return{adminId:t.adminId,name:t.name,grade:t.grade}}async function b(){const t=await(await fetch("/partials/head.html")).text();document.head.innerHTML+=t;const s=await(await fetch("/partials/layout.html")).text(),o=document.createElement("div");o.innerHTML=s,document.body.prepend(o);const a=await(await fetch("/partials/header.html")).text(),i=document.createElement("div");if(i.innerHTML=a,document.body.prepend(i),window.location.pathname!=="/html/log.html"){const l=document.createElement("script");l.src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js",l.onload=()=>{const d=document.createElement("script");d.src="/src/js/common.js",document.body.appendChild(d)},document.head.appendChild(l)}}document.addEventListener("DOMContentLoaded",async()=>{console.log("✅ main.ts 실행됨");const n=window.location.pathname;n!="/html/log.html"&&n!="/html/dashboard.html"&&(await L(),await b());const t=await P();if(t){const e=document.getElementById("user-name"),s=document.getElementById("user-grade");if(e&&(e.textContent=`${t.adminId} 님`),s){const o={1:"총괄관리자",2:"운영관리자",3:"프랜차이즈",4:"일반회원"}[t.grade]||"일반회원";s.innerHTML=`<span>${o}</span>`,s.classList.remove("manager","franchise","store"),t.grade===1&&s.classList.add("manager"),t.grade===3&&s.classList.add("franchise"),t.grade===4&&s.classList.add("store")}}if(t&&t.grade<=2){const e=document.querySelector(".sidemenu .menu");[{href:"/html/notice.html?type=admin",label:"관리자 공지사항"},{href:"/html/notice.html?type=notice",label:"홈페이지 공지사항"},{href:"/html/notice.html?type=store",label:"설치매장"},{href:"/html/notice.html?type=news",label:"언론보도"},{href:"/html/notice.html?type=machine",label:"머신사용설명"},{href:"/html/empowerment.html",label:"권한 관리"}].forEach(o=>{const r=document.createElement("li");r.innerHTML=`<a href="${o.href}"><p>${o.label}</p></a>`,e==null||e.appendChild(r)})}n==="/index.html"||n==="/"?console.log("index 페이지"):n==="/html/log.html"?(console.log("📌 로그인 페이지 - login.ts 로드"),c(()=>import("./login-BZPhMqVc.js"),[],import.meta.url).then(e=>{e.initLogin()})):n==="/html/home.html"?(console.log("📌 홈 페이지 - home.ts 로드"),c(()=>import("./home-tuB31n18.js"),[],import.meta.url).then(e=>{e.initHome()})):n==="/html/point.html"?(console.log("📌 포인트 - point.ts 로드"),c(()=>import("./point-BqPqUluq.js"),__vite__mapDeps([0,1,2]),import.meta.url).then(e=>{e.initPoint()})):n==="/html/product.html"?(console.log("📌 상품 - product.ts 로드"),c(()=>import("./product-CfvPoXjY.js"),__vite__mapDeps([3,2,1]),import.meta.url).then(e=>{e.initProduct()})):n==="/html/product-detail.html"?(console.log("📌 상품상세 - productDetail.ts 로드"),c(()=>import("./productDetail-CdGYonxX.js"),__vite__mapDeps([4,2,1]),import.meta.url).then(e=>{e.initProductDetail()})):n==="/html/product-add.html"?(console.log("📌 상품등록 - productAdd.ts 로드"),c(()=>import("./productAdd-D9aT_PDN.js"),__vite__mapDeps([5,2]),import.meta.url).then(e=>{e.initProductAdd()})):n==="/html/register.html"?(console.log("📌 회원가입 페이지 - register.ts 로드"),c(()=>import("./register-DYREsxVe.js"),[],import.meta.url).then(e=>{e.initRegister()})):n==="/html/notice.html"?(console.log("📌 관리자 공지사항등록 - notice.ts 로드"),c(()=>import("./notice-C-EMZOji.js"),__vite__mapDeps([6,1,7]),import.meta.url).then(e=>{e.initNotice()})):n==="/html/franchise_dashboard.html"?(console.log("🏘️ 프랜차이즈 - franchise.ts 로드"),c(()=>import("./franchise-BqQbRFTF.js"),[],import.meta.url).then(e=>{e.franchiseEdit()})):n==="/html/store_dashboard.html"?(console.log("📌 데쉬보드 - store_dashboard.ts 로드"),c(()=>import("./store-p9FV3yAN.js"),[],import.meta.url).then(e=>{e.storeEdit()})):console.log("📌 기본 페이지")});window.addEventListener("load",()=>{document.body.style.visibility="visible"});export{g as f,P as g};
