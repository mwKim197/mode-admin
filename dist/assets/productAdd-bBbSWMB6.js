import{r as Y,h as M,v as L,a as _}from"./imageUploader-CoF5UYvm.js";import{g as x,e as C}from"./main-CIk-r9F8.js";let u,s;async function H(){const n=x();if(!n){alert("사용자 정보가 없습니다.");return}await Y(null),document.getElementById("logoUpload").addEventListener("change",async e=>{await V(e)});const o=document.getElementById("saveDtlBtn");o&&o.addEventListener("click",async()=>{const e=j(n.userId);if(!u||!s){window.showToast("이미지 등록은 필수입니다.",3e3,"warning");return}const t=L(e);if(t){window.showToast(t,3e3,"warning");return}const a=_(e);if(a){window.showToast(a,3e3,"warning");return}if(confirm("신규 메뉴를 등록하시겠습니까?")){const i={userId:n.userId,data:e,...u&&s&&{originalFileName:s,imageBase64:u}};try{if(!(await C("/model_admin_menu?func=set-new-menu",i)).ok){window.showToast("신규 메뉴 등록에 실패하였습니다.",3e3,"error");return}alert("신규 메뉴가 등록되었습니다.")}catch(r){console.error("등록 중 오류 발생:",r),window.showToast("오류가 발생했습니다.",3e3,"error")}}})}async function V(n){const l=n.target,o=document.getElementById("logoPreview"),e=document.getElementById("fileName");if(!e){window.showToast("에러발생",3e3,"error");return}try{const{base64:t,fileName:a}=await M(l,o,e);u=t,s=a}catch(t){window.showToast("이미지 업로드 실패",3e3,"error"),console.warn("이미지 업로드 실패:",t)}}function j(n){var m,d,g,p;const o=Number(document.getElementById("menu-no").value),e=document.getElementById("menu-name").value,t=document.getElementById("menu-price").value.trim(),a=document.getElementById("menu-category").value,i=((m=document.querySelector('input[name="cupYn"]:checked'))==null?void 0:m.value)||"no",r=((d=document.querySelector('input[name="cup"]:checked'))==null?void 0:d.value)||"",E=((g=document.querySelector('input[name="iceYn"]:checked'))==null?void 0:g.value)||"",S=((p=document.querySelector('input[name="empty"]:checked'))==null?void 0:p.value)||"",T=document.getElementById("ice-time").value.trim(),k=document.getElementById("water-time").value.trim(),q="",F={best:document.getElementById("state-best").value,event:document.getElementById("state-event").value,new:document.getElementById("state-new").value},N=Array.from(document.querySelectorAll(".item")).map((w,U)=>{var v,I,f,h,B;const y=((v=w.querySelector(".item-type-select"))==null?void 0:v.value)||"",c=w.querySelectorAll("input"),b=String(parseFloat(((I=c[0])==null?void 0:I.value)||"0")),A=String(parseFloat(((f=c[1])==null?void 0:f.value)||"0")),D=String(parseFloat(((h=c[2])==null?void 0:h.value)||"0")),P=y==="garucha"?"0":String(parseFloat(((B=c[3])==null?void 0:B.value)||"0"));return{no:String(U+1),type:y,value1:b,value2:A,value3:D,value4:P}});return{userId:n,menuId:0,no:o,name:e,price:t,category:a,cupYn:i,cup:r,empty:S,iceYn:E,iceTime:T,waterTime:k,image:q,state:F,items:N}}export{H as initProductAdd};
