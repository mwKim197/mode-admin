const r="https://api.narrowroad-model.com";function d(){console.log("âœ… login.ts ë¡œë“œë¨");const l=document.getElementById("login-form");if(!l){console.error("âŒ ë¡œê·¸ì¸ í¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŒ");return}l.addEventListener("submit",async a=>{a.preventDefault(),localStorage.removeItem("authToken"),console.log("ğŸ—‘ï¸ ê¸°ì¡´ ë¡œê·¸ì¸ í† í° ì‚­ì œë¨");const s=document.getElementById("adminId").value.trim(),t=document.getElementById("password").value.trim();if(!s||!t){alert("ì•„ì´ë””ì™€ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.");return}try{const e=await fetch(`${r}/model_admin_login?func=login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({adminId:s,password:t}),mode:"cors"}),n=await e.json();e.ok?(localStorage.setItem("authToken",n.token),console.log("âœ… ë¡œê·¸ì¸ ì„±ê³µ â†’ í† í° ì €ì¥ ì™„ë£Œ!"),window.location.href="../../html/dashboard.html"):alert(n.message||"ë¡œê·¸ì¸ ì‹¤íŒ¨. ë‹¤ì‹œ ì‹œë„í•˜ì„¸ìš”.")}catch(e){console.error("âŒ ë¡œê·¸ì¸ ì˜¤ë¥˜:",e),alert("ì„œë²„ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•˜ì„¸ìš”.")}});const i=document.getElementById("kakao-login-btn");i&&i.addEventListener("click",c)}function c(){const a="https://kauth.kakao.com/oauth/authorize?response_type=code&client_id=240886095629b93f9655026145a39487&redirect_uri=http://model-web-admin.s3-website.ap-northeast-2.amazonaws.com/html/kakao-callback.html";if(window.matchMedia("(max-width: 768px)").matches)console.log("ğŸ“± ëª¨ë°”ì¼ í™˜ê²½ â†’ ë¦¬ë””ë ‰íŠ¸ ë°©ì‹"),window.location.href=a;else{console.log("ğŸ’» PC í™˜ê²½ â†’ íŒì—… ë¡œê·¸ì¸ ì‚¬ìš©");const t=window.open(a,"kakaoLogin","width=500,height=700");window.addEventListener("message",e=>{if(e.origin!=="http://model-web-admin.s3-website.ap-northeast-2.amazonaws.com")return;const{code:n}=e.data;n&&(console.log("âœ… ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ ì½”ë“œ ë°›ìŒ:",n),t==null||t.close(),fetch(`${r}/model_admin_login?func=kakao-login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({code:n})}).then(o=>o.json()).then(o=>{o.token?(localStorage.removeItem("authToken"),console.log("ğŸ—‘ï¸ ê¸°ì¡´ ë¡œê·¸ì¸ í† í° ì‚­ì œë¨"),localStorage.setItem("authToken",o.token),console.log("âœ… ë¡œê·¸ì¸ ì„±ê³µ â†’ í† í° ì €ì¥ ì™„ë£Œ!"),window.location.href="../../html/dashboard.html"):o.redirectUrl?(console.log("âœ… ì‹ ê·œ ì‚¬ìš©ì â†’ ì—°ë™ í˜ì´ì§€ë¡œ ì´ë™:",o.redirectUrl),window.location.href=o.redirectUrl):alert("ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ ì‹¤íŒ¨. ë‹¤ì‹œ ì‹œë„í•˜ì„¸ìš”.")}).catch(o=>{console.error("âŒ ë¡œê·¸ì¸ ì˜¤ë¥˜:",o)}))})}}export{d as initLogin};
