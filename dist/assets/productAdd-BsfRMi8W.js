import{r as U,h as L,v as P,a as V}from"./imageUploader-BHq8Bjd8.js";import{g as M,e as R}from"./main-B9kbHsQX.js";let p,g;async function j(){const c=M();if(!c){window.showToast("사용자 정보가 없습니다.",3e3,"error");return}await U(null),document.getElementById("logoUpload").addEventListener("change",async n=>{await C(n)});const l=document.getElementById("saveDtlBtn");if(l){let n=function(){var t;const e=(t=document.querySelector('input[name="iceYn"]:checked'))==null?void 0:t.value;u&&(u.style.display=e==="no"?"none":"block")},o=function(){var a;const t=((a=document.querySelector('input[name="cupYn"]:checked'))==null?void 0:a.value)==="yes";i&&(i.style.display=t?"none":"block"),d&&(d.style.display=t?"none":"block"),m&&(m.style.display=t?"none":"block")};l.addEventListener("click",async()=>{const e=_(c.userId);if(!p||!g){window.showToast("이미지 등록은 필수입니다.",3e3,"warning");return}const t=P(e);if(t){window.showToast(t,3e3,"warning");return}const a=V(e);if(a){window.showToast(a,3e3,"warning");return}if(confirm("신규 메뉴를 등록하시겠습니까?")){const h={userId:c.userId,data:e,...p&&g&&{originalFileName:g,imageBase64:p}};try{if(!(await R("/model_admin_menu?func=set-new-menu",h)).ok){window.showToast("신규 메뉴 등록에 실패하였습니다.",3e3,"error");return}window.showToast("신규 메뉴가 등록되었습니다."),setTimeout(()=>{window.location.href="/html/product.html"},1e3)}catch(s){console.error("등록 중 오류 발생:",s),window.showToast("오류가 발생했습니다.",3e3,"error")}}});const r=document.querySelectorAll('input[name="iceYn"]'),u=document.getElementById("ice-water-time-box");r.forEach(e=>{e.addEventListener("change",n)}),n();const v=document.querySelectorAll('input[name="cupYn"]'),i=document.getElementById("items-container"),d=document.getElementById("cup-ice-selection-box"),m=document.getElementById("ice-water-time-box");v.forEach(e=>{e.addEventListener("change",o)}),o()}}async function C(c){const w=c.target,l=document.getElementById("logoPreview"),n=document.getElementById("fileName");if(!n){window.showToast("에러발생",3e3,"error");return}try{const{base64:o,fileName:r}=await L(w,l,n);p=o,g=r}catch(o){window.showToast("이미지 업로드 실패",3e3,"error"),console.warn("이미지 업로드 실패:",o)}}function _(c){var s,I,f,B;const l=Number(document.getElementById("menu-no").value),n=document.getElementById("menu-name").value,o=document.getElementById("menu-price").value.trim(),r=document.getElementById("menu-category").value,u=((s=document.querySelector('input[name="cupYn"]:checked'))==null?void 0:s.value)||"no",v=((I=document.querySelector('input[name="cup"]:checked'))==null?void 0:I.value)||"",i=((f=document.querySelector('input[name="iceYn"]:checked'))==null?void 0:f.value)||"",d=((B=document.querySelector('input[name="empty"]:checked'))==null?void 0:B.value)||"",m=document.getElementById("ice-time").value.trim(),e=document.getElementById("water-time").value.trim(),t="",a={best:document.getElementById("state-best").value,event:document.getElementById("state-event").value,new:document.getElementById("state-new").value},h=Array.from(document.querySelectorAll(".item")).map((E,x)=>{var T,k,b,q,Y;const S=((T=E.querySelector(".item-type-select"))==null?void 0:T.value)||"",y=E.querySelectorAll("input"),F=String(parseFloat(((k=y[0])==null?void 0:k.value)||"0")),A=String(parseFloat(((b=y[1])==null?void 0:b.value)||"0")),N=String(parseFloat(((q=y[2])==null?void 0:q.value)||"0")),D=S==="garucha"?"0":String(parseFloat(((Y=y[3])==null?void 0:Y.value)||"0"));return{no:String(x+1),type:S,value1:F,value2:A,value3:N,value4:D}});return{userId:c,menuId:0,no:l,name:n,price:o,category:r,cupYn:u,cup:v,empty:d,iceYn:i,iceTime:m,waterTime:e,image:t,state:a,items:h}}export{j as initProductAdd};
