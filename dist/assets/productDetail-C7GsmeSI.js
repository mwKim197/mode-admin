import{r as C,v as G,a as H,h as j}from"./imageUploader-DictYghS.js";import{g as W,a as z,d as J}from"./main-EK_b97v8.js";let g,w;async function Z(){const v=document.querySelector(".back-box");v&&(v.style.display="flex");const I=h("menuId");if(!I)return;const d=W();if(!d){window.showToast("사용자 정보가 없습니다.",3e3,"warning");return}const P=await(await z(`/model_admin_menu?userId=${d.userId}&menuId=${I}&func=get-menu-by-id`)).json();await C(P),document.getElementById("logoUpload").addEventListener("change",async n=>{await A(n)});const f=document.getElementById("saveDtlBtn");if(f){let n=function(){var a,c;const e=(a=document.querySelector('input[name="iceYn"]:checked'))==null?void 0:a.value,u=(c=document.querySelector('input[name="cupYn"]:checked'))==null?void 0:c.value,t=document.getElementById("ice-water-time-box");t&&(u==="yes"?t.style.display="none":t.style.display=e==="no"?"none":"block")},s=function(){var a,c;const e=(a=document.querySelector('input[name="cupYn"]:checked'))==null?void 0:a.value,u=(c=document.querySelector('input[name="iceYn"]:checked'))==null?void 0:c.value,t=e==="yes";if(o&&(o.style.display=t?"none":"block"),i&&(i.style.display=t?"none":"block"),p){const r=t||u==="no";p.style.display=r?"none":"block"}};f.addEventListener("click",async()=>{const e=D(d.userId),u=G(e);if(u){window.showToast(u,3e3,"warning");return}const t=H(e);if(t){window.showToast(t,3e3,"warning");return}const a={...e,...g&&w&&{originalFileName:w,imageBase64:g}};if(confirm("수정사항을 저장하시겠습니까?")){const c={userId:d.userId,updatedData:a};try{if((await J("/model_admin_menu?func=put-update-menu",c)).ok)window.showToast("수정사항 저장완료."),setTimeout(()=>{window.location.href="/html/product.html"},1e3);else{window.showToast("수정사항 저장에 실패하였습니다.",3e3,"error");return}}catch{}}}),document.querySelectorAll('input[name="iceYn"]').forEach(e=>{e.addEventListener("change",n)}),n();const l=document.querySelectorAll('input[name="cupYn"]'),o=document.getElementById("items-container"),i=document.getElementById("cup-ice-selection-box"),p=document.getElementById("ice-water-time-box");l.forEach(e=>{e.addEventListener("change",()=>{s(),n()})}),s()}function h(n){return new URLSearchParams(window.location.search).get(n)}async function A(n){const s=n.target,m=document.getElementById("logoPreview"),l=document.getElementById("fileName");if(!l){window.showToast("에러발생",3e3,"error");return}try{const{base64:o,fileName:i}=await j(s,m,l);g=o,w=i}catch(o){window.showToast(`이미지 업로드 실패: ${o}`,3e3,"warning"),console.warn("이미지 업로드 실패:",o)}}function D(n){var B,E,S,k;const s=Number(h("menuId")||"0"),m=Number(document.getElementById("menu-no").value),l=document.getElementById("menu-name").value,o=document.getElementById("menu-price").value.trim(),i=document.getElementById("menu-category").value,p=((B=document.querySelector('input[name="cupYn"]:checked'))==null?void 0:B.value)||"no",e=((E=document.querySelector('input[name="cup"]:checked'))==null?void 0:E.value)||"",u=((S=document.querySelector('input[name="iceYn"]:checked'))==null?void 0:S.value)||"",t=((k=document.querySelector('input[name="empty"]:checked'))==null?void 0:k.value)||"",a=document.getElementById("ice-time").value.trim(),c=document.getElementById("water-time").value.trim(),r="",R={best:document.getElementById("state-best").value,event:document.getElementById("state-event").value,new:document.getElementById("state-new").value},U=Array.from(document.querySelectorAll(".item")).map((b,L)=>{var T,Y,x,F,N;const q=((T=b.querySelector(".item-type-select"))==null?void 0:T.value)||"",y=b.querySelectorAll("input"),V=String(parseFloat(((Y=y[0])==null?void 0:Y.value)||"0")),_=String(parseFloat(((x=y[1])==null?void 0:x.value)||"0")),M=String(parseFloat(((F=y[2])==null?void 0:F.value)||"0")),$=q==="garucha"?"0":String(parseFloat(((N=y[3])==null?void 0:N.value)||"0"));return{no:String(L+1),type:q,value1:V,value2:_,value3:M,value4:$}});return{userId:n,menuId:s,no:m,name:l,price:o,category:i,cupYn:p,cup:e,empty:t,iceYn:u,iceTime:a,waterTime:c,image:r,state:R,items:U}}}export{Z as initProductDetail};
