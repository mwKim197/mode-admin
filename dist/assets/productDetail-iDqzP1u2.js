import{r as C,v as G,a as H,h as j}from"./imageUploader-Bo-Egzif.js";import{g as W,a as z,d as J}from"./main-BTQuD9qN.js";let y,g;async function Z(){const w=document.querySelector(".back-box");w&&(w.style.display="flex");const v=f("menuId");if(!v)return;const d=W();if(!d){window.showToast("사용자 정보가 없습니다.",3e3,"warning");return}const N=await(await z(`/model_admin_menu?userId=${d.userId}&menuId=${v}&func=get-menu-by-id`)).json();await C(N),document.getElementById("logoUpload").addEventListener("change",async n=>{await P(n)});const I=document.getElementById("saveDtlBtn");if(I){let n=function(){var a,c;const t=(a=document.querySelector('input[name="iceYn"]:checked'))==null?void 0:a.value,u=(c=document.querySelector('input[name="cupYn"]:checked'))==null?void 0:c.value,e=document.getElementById("ice-water-time-box");e&&(u==="yes"?e.style.display="none":e.style.display=t==="no"?"none":"block")},l=function(){var a,c;const t=(a=document.querySelector('input[name="cupYn"]:checked'))==null?void 0:a.value,u=(c=document.querySelector('input[name="iceYn"]:checked'))==null?void 0:c.value,e=t==="yes";if(s&&(s.style.display=e?"none":"block"),o&&(o.style.display=e?"none":"block"),i){const m=e||u==="no";i.style.display=m?"none":"block"}};I.addEventListener("click",async()=>{const t=D(d.userId),u=G(t);if(u){window.showToast(u,3e3,"warning");return}const e=H(t);if(e){window.showToast(e,3e3,"warning");return}const a={...t,...y&&g&&{originalFileName:g,imageBase64:y}};if(confirm("수정사항을 저장하시겠습니까?")){const c={userId:d.userId,updatedData:a};try{if((await J("/model_admin_menu?func=put-update-menu",c)).ok)window.showToast("수정사항 저장완료."),setTimeout(()=>{window.location.href="/html/product.html"},1e3);else{window.showToast("수정사항 저장에 실패하였습니다.",3e3,"error");return}}catch{}}}),n();const r=document.querySelectorAll('input[name="cupYn"]'),s=document.getElementById("items-container"),o=document.getElementById("cup-ice-selection-box"),i=document.getElementById("ice-water-time-box");r.forEach(t=>{t.addEventListener("change",()=>{l(),n()})}),l()}function f(n){return new URLSearchParams(window.location.search).get(n)}async function P(n){const l=n.target,r=document.getElementById("logoPreview"),s=document.getElementById("fileName");if(!s){window.showToast("에러발생",3e3,"error");return}try{const{base64:o,fileName:i}=await j(l,r,s);y=o,g=i}catch(o){window.showToast(`이미지 업로드 실패: ${o}`,3e3,"warning"),console.warn("이미지 업로드 실패:",o)}}function D(n){var h,B,E,S;const l=Number(f("menuId")||"0"),r=Number(document.getElementById("menu-no").value),s=document.getElementById("menu-name").value,o=document.getElementById("menu-price").value.trim(),i=document.getElementById("menu-category").value,t=((h=document.querySelector('input[name="cupYn"]:checked'))==null?void 0:h.value)||"no",u=((B=document.querySelector('input[name="cup"]:checked'))==null?void 0:B.value)||"",e=((E=document.querySelector('input[name="iceYn"]:checked'))==null?void 0:E.value)||"",a=((S=document.querySelector('input[name="empty"]:checked'))==null?void 0:S.value)||"",c=document.getElementById("ice-time").value.trim(),m=document.getElementById("water-time").value.trim(),U="",A={best:document.getElementById("state-best").value,event:document.getElementById("state-event").value,new:document.getElementById("state-new").value},V=Array.from(document.querySelectorAll(".item")).map((b,L)=>{var q,T,Y,x,F;const k=((q=b.querySelector(".item-type-select"))==null?void 0:q.value)||"",p=b.querySelectorAll("input"),R=String(parseFloat(((T=p[0])==null?void 0:T.value)||"0")),_=String(parseFloat(((Y=p[1])==null?void 0:Y.value)||"0")),M=String(parseFloat(((x=p[2])==null?void 0:x.value)||"0")),$=k==="garucha"?"0":String(parseFloat(((F=p[3])==null?void 0:F.value)||"0"));return{no:String(L+1),type:k,value1:R,value2:_,value3:M,value4:$}});return{userId:n,menuId:l,no:r,name:s,price:o,category:i,cupYn:t,cup:u,empty:a,iceYn:e,iceTime:c,waterTime:m,barcode:"",image:U,state:A,items:V}}}export{Z as initProductDetail};
