import{r as M,v as Y,a as A,h as R}from"./imageUploader-Tls3sn5C.js";import{g as q,a as j,d as x,e as G}from"./main-D3Li0W75.js";let v,I;async function J(){const e=F("menuId");if(!e)return;const t=q();if(!t){window.showToast("사용자 정보가 없습니다.",3e3,"warning");return}const a=await(await j(`/model_admin_menu?userId=${t.userId}&menuId=${e}&func=get-menu-by-id`)).json();await M(a),document.getElementById("logoUpload").addEventListener("change",async r=>{await O(r)});const c=document.getElementById("saveDtlBtn");c&&c.addEventListener("click",async()=>{const r=V(t.userId),d=Y(r);if(d){window.showToast(d,3e3,"warning");return}const m=A(r);if(m){window.showToast(m,3e3,"warning");return}const w={...r,...v&&I&&{originalFileName:I,imageBase64:v}};if(confirm("수정사항을 저장하시겠습니까?")){const p={userId:t.userId,updatedData:w};try{if((await x("/model_admin_menu?func=put-update-menu",p)).ok)window.showToast("수정사항 저장완료.");else{window.showToast("수정사항 저장에 실패하였습니다.",3e3,"error");return}}catch{}}});const s=document.getElementById("btnPlasticCup");s&&s.addEventListener("click",()=>{confirm("플라스틱 컵을 배출하시겠습니까?")&&y("pl")});const i=document.getElementById("btnPaperCup");i&&i.addEventListener("click",()=>{confirm("종이컵을 배출하시겠습니까?")&&y("pa")});const u=document.getElementById("btnDrinkOrder");u&&u.addEventListener("click",()=>{confirm("현재 설정으로 음료를 투출하시겠습니까?")&&y("drink",a)})}async function y(e,t={}){const o=q();if(!o){window.showToast("❌ 사용자 정보가 없습니다.",3e3,"error");return}const a={func:e,userId:o.userId,...e==="order"?{orderData:{recipe:t}}:{}};G("/model_machine_controll",a).then(()=>{window.showToast(`${e} 명령 전송 완료`)}).catch(n=>{console.error(`❌ ${e} 명령 전송 실패:`,n),window.showToast(`❌ ${e} 명령 전송 실패: ${n} `,3e3,"error")}),window.showToast(`${e} 명령 전송`)}function F(e){return new URLSearchParams(window.location.search).get(e)}async function O(e){const t=e.target,o=document.getElementById("logoPreview"),a=document.getElementById("fileName");if(!a){window.showToast("에러발생",3e3,"error");return}try{const{base64:n,fileName:c}=await R(t,o,a);v=n,I=c}catch(n){window.showToast(`이미지 업로드 실패: ${n}`,3e3,"warning"),console.warn("이미지 업로드 실패:",n)}}function V(e){var h,f,B,E;const t=Number(F("menuId")||"0"),o=Number(document.getElementById("menu-no").value),a=document.getElementById("menu-name").value,n=document.getElementById("menu-price").value.trim(),c=document.getElementById("menu-category").value,s=((h=document.querySelector('input[name="cupYn"]:checked'))==null?void 0:h.value)||"no",i=((f=document.querySelector('input[name="cup"]:checked'))==null?void 0:f.value)||"",u=((B=document.querySelector('input[name="iceYn"]:checked'))==null?void 0:B.value)||"",r=((E=document.querySelector('input[name="empty"]:checked'))==null?void 0:E.value)||"",d=document.getElementById("ice-time").value.trim(),m=document.getElementById("water-time").value.trim(),w="",p={best:document.getElementById("state-best").value,event:document.getElementById("state-event").value,new:document.getElementById("state-new").value},g=Array.from(document.querySelectorAll(".item")).map((S,N)=>{var k,b,P,D,$;const T=((k=S.querySelector(".item-type-select"))==null?void 0:k.value)||"",l=S.querySelectorAll("input"),L=String(parseFloat(((b=l[0])==null?void 0:b.value)||"0")),U=String(parseFloat(((P=l[1])==null?void 0:P.value)||"0")),_=String(parseFloat(((D=l[2])==null?void 0:D.value)||"0")),C=T==="garucha"?"0":String(parseFloat((($=l[3])==null?void 0:$.value)||"0"));return{no:String(N+1),type:T,value1:L,value2:U,value3:_,value4:C}});return{userId:e,menuId:t,no:o,name:a,price:n,category:c,cupYn:s,cup:i,empty:r,iceYn:u,iceTime:d,waterTime:m,image:w,state:p,items:g}}export{J as initProductDetail};
