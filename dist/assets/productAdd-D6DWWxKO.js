import{r as U,h as L,v as P,a as V}from"./imageUploader-DictYghS.js";import{g as M,e as R}from"./main-EK_b97v8.js";let w,v;async function j(){const a=document.querySelector(".back-box");a&&(a.style.display="flex");const l=M();if(!l){window.showToast("사용자 정보가 없습니다.",3e3,"error");return}await U(null),document.getElementById("logoUpload").addEventListener("change",async n=>{await C(n)});const o=document.getElementById("saveDtlBtn");if(o){let n=function(){var t;const e=(t=document.querySelector('input[name="iceYn"]:checked'))==null?void 0:t.value;i&&(i.style.display=e==="no"?"none":"block")},s=function(){var c;const t=((c=document.querySelector('input[name="cupYn"]:checked'))==null?void 0:c.value)==="yes";d&&(d.style.display=t?"none":"block"),m&&(m.style.display=t?"none":"block"),y&&(y.style.display=t?"none":"block")};o.addEventListener("click",async()=>{const e=_(l.userId);if(!w||!v){window.showToast("이미지 등록은 필수입니다.",3e3,"warning");return}const t=P(e);if(t){window.showToast(t,3e3,"warning");return}const c=V(e);if(c){window.showToast(c,3e3,"warning");return}if(confirm("신규 메뉴를 등록하시겠습니까?")){const p={userId:l.userId,data:e,...w&&v&&{originalFileName:v,imageBase64:w}};try{if(!(await R("/model_admin_menu?func=set-new-menu",p)).ok){window.showToast("신규 메뉴 등록에 실패하였습니다.",3e3,"error");return}window.showToast("신규 메뉴가 등록되었습니다."),setTimeout(()=>{window.location.href="/html/product.html"},1e3)}catch(r){console.error("등록 중 오류 발생:",r),window.showToast("오류가 발생했습니다.",3e3,"error")}}});const f=document.querySelectorAll('input[name="iceYn"]'),i=document.getElementById("ice-water-time-box");f.forEach(e=>{e.addEventListener("change",n)}),n();const h=document.querySelectorAll('input[name="cupYn"]'),d=document.getElementById("items-container"),m=document.getElementById("cup-ice-selection-box"),y=document.getElementById("ice-water-time-box");h.forEach(e=>{e.addEventListener("change",s)}),s()}}async function C(a){const l=a.target,u=document.getElementById("logoPreview"),o=document.getElementById("fileName");if(!o){window.showToast("에러발생",3e3,"error");return}try{const{base64:n,fileName:s}=await L(l,u,o);w=n,v=s}catch(n){window.showToast("이미지 업로드 실패",3e3,"error"),console.warn("이미지 업로드 실패:",n)}}function _(a){var p,r,I,B;const u=Number(document.getElementById("menu-no").value),o=document.getElementById("menu-name").value,n=document.getElementById("menu-price").value.trim(),s=document.getElementById("menu-category").value,f=((p=document.querySelector('input[name="cupYn"]:checked'))==null?void 0:p.value)||"no",i=((r=document.querySelector('input[name="cup"]:checked'))==null?void 0:r.value)||"",h=((I=document.querySelector('input[name="iceYn"]:checked'))==null?void 0:I.value)||"",d=((B=document.querySelector('input[name="empty"]:checked'))==null?void 0:B.value)||"",m=document.getElementById("ice-time").value.trim(),y=document.getElementById("water-time").value.trim(),e="",t={best:document.getElementById("state-best").value,event:document.getElementById("state-event").value,new:document.getElementById("state-new").value},c=Array.from(document.querySelectorAll(".item")).map((E,Y)=>{var k,T,b,q,x;const S=((k=E.querySelector(".item-type-select"))==null?void 0:k.value)||"",g=E.querySelectorAll("input"),F=String(parseFloat(((T=g[0])==null?void 0:T.value)||"0")),A=String(parseFloat(((b=g[1])==null?void 0:b.value)||"0")),N=String(parseFloat(((q=g[2])==null?void 0:q.value)||"0")),D=S==="garucha"?"0":String(parseFloat(((x=g[3])==null?void 0:x.value)||"0"));return{no:String(Y+1),type:S,value1:F,value2:A,value3:N,value4:D}});return{userId:a,menuId:0,no:u,name:o,price:n,category:s,cupYn:f,cup:i,empty:d,iceYn:h,iceTime:m,waterTime:y,image:e,state:t,items:c}}export{j as initProductAdd};
