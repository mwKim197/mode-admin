function k(){T(),C()}function C(){const s=document.querySelector(".btn-outline");s&&s.addEventListener("click",t=>{t.preventDefault(),b()})}let e=null;async function T(){try{const t=JSON.parse(localStorage.getItem("userInfo")||"{}").userId;if(!t)return;const o=await(await fetch(`https://api.narrowroad-model.com/model_user_setting?func=get-user&userId=${t}`)).json();if(o&&o.user){e=o.user;const a=document.querySelector('input[name="player-id"]');a&&(a.value=o.user.storeName||"");const d=document.querySelector("#tel-input");d&&(d.value=o.user.tel||"");const r=document.querySelector('.in-box input[type="text"]');r&&(r.value=o.user.limitCount||"");const n=document.querySelector("#wash-time-input");n&&(n.value=o.user.washTime||"");const c=document.querySelector('input[placeholder="원격 주소"]');c&&(c.value=o.user.ipAddress||"");const I=document.querySelectorAll('input[type="checkbox"]')[1];I&&(I.checked=!o.user.payType)}}catch{y("매장 정보 로드에 실패했습니다.")}}async function b(){var s;try{const t=JSON.parse(localStorage.getItem("userInfo")||"{}"),p=localStorage.getItem("authToken");if(!p)return;const o=t.userId||"zero001",a=document.querySelector('input[name="player-id"]'),d=document.querySelector("#tel-input"),r=document.querySelector('input[placeholder="원격 주소"]'),n=document.querySelector('input[type="password"]'),c=document.querySelector('.in-box input[type="text"]'),i=document.querySelector("#wash-time-input"),m=document.querySelectorAll('input[type="checkbox"]')[1];let l=!1,w=!1;if(r&&r.value!==(e==null?void 0:e.ipAddress)&&(l=!0),i&&i.value!==(e==null?void 0:e.washTime)&&(l=!0),m&&m.checked!==!(e!=null&&e.payType)&&(l=!0),n&&n.value!==""&&n.value!=="******"){if(n.value.length<6){y("비밀번호는 6자리 이상이어야 합니다.");return}w=!0}const f=(c==null?void 0:c.value)||"",S=((s=e==null?void 0:e.limitCount)==null?void 0:s.toString())||"";if(c&&f!==""&&f!==S&&(l=!0),!l&&!w){y("변경사항이 없습니다.");return}if(l){const u={userId:o,adminId:o};a&&a.value!==(e==null?void 0:e.storeName)&&(u.storeName=a.value),d&&d.value!==(e==null?void 0:e.tel)&&(u.tel=d.value),r&&r.value!==(e==null?void 0:e.ipAddress)&&(u.ipAddress=r.value),i&&i.value!==(e==null?void 0:e.washTime)&&(u.washTime=i.value),m&&m.checked!==!(e!=null&&e.payType)&&(u.payType=!m.checked),c&&f!==""&&f!==S&&(u.limitCount=parseInt(f));const v=await fetch("https://api.narrowroad-model.com/model_user_setting?func=update-user",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${p}`},body:JSON.stringify(u)}),h=await v.json();if(console.log("📥 일반 정보 API 응답:",h),h.success||h.status==="success"||v.ok){const x={userId:o,func:"update-user"};await fetch("https://api.narrowroad-model.com/model_machine_controll",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${p}`},body:JSON.stringify(x)})}}if(w){const u={userId:o,newPassword:n.value,adminId:o},h=await(await fetch("https://api.narrowroad-model.com/model_user_setting?func=update-password",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${p}`},body:JSON.stringify(u)})).json();console.log("📥 비밀번호 API 응답:",h)}y("변경사항이 저장되었습니다."),n&&(n.value="******")}catch(t){console.error("❌ 저장 중 오류:",t),y("저장 중 오류가 발생했습니다.")}}function y(s){const t=document.createElement("div");t.style.cssText=`
    position: fixed;
    top: 20px;
    left: 50%;
    transform: translateX(-50%);
    background: #4CAF50;
    color: white;
    padding: 12px 24px;
    border-radius: 8px;
    z-index: 10000;
    font-size: 14px;
  `,t.textContent=s,document.body.appendChild(t),setTimeout(()=>{t.parentNode&&t.parentNode.removeChild(t)},3e3)}export{k as initNormalSet};
