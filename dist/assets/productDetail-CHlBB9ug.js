import{r as $,v as C,a as G,h as H}from"./imageUploader-aLZrVVWe.js";import{g as j,a as W,d as z}from"./main-B9HJQf1x.js";let g,w;async function X(){const v=h("menuId");if(!v)return;const d=j();if(!d){window.showToast("사용자 정보가 없습니다.",3e3,"warning");return}const N=await(await W(`/model_admin_menu?userId=${d.userId}&menuId=${v}&func=get-menu-by-id`)).json();await $(N),document.getElementById("logoUpload").addEventListener("change",async n=>{await P(n)});const I=document.getElementById("saveDtlBtn");if(I){let n=function(){var a,c;const e=(a=document.querySelector('input[name="iceYn"]:checked'))==null?void 0:a.value,u=(c=document.querySelector('input[name="cupYn"]:checked'))==null?void 0:c.value,t=document.getElementById("ice-water-time-box");t&&(u==="yes"?t.style.display="none":t.style.display=e==="no"?"none":"block")},s=function(){var a,c;const e=(a=document.querySelector('input[name="cupYn"]:checked'))==null?void 0:a.value,u=(c=document.querySelector('input[name="iceYn"]:checked'))==null?void 0:c.value,t=e==="yes";if(o&&(o.style.display=t?"none":"block"),i&&(i.style.display=t?"none":"block"),p){const r=t||u==="no";p.style.display=r?"none":"block"}};I.addEventListener("click",async()=>{const e=A(d.userId),u=C(e);if(u){window.showToast(u,3e3,"warning");return}const t=G(e);if(t){window.showToast(t,3e3,"warning");return}const a={...e,...g&&w&&{originalFileName:w,imageBase64:g}};if(confirm("수정사항을 저장하시겠습니까?")){const c={userId:d.userId,updatedData:a};try{if((await z("/model_admin_menu?func=put-update-menu",c)).ok)window.showToast("수정사항 저장완료."),setTimeout(()=>{window.location.href="/html/product.html"},1e3);else{window.showToast("수정사항 저장에 실패하였습니다.",3e3,"error");return}}catch{}}}),document.querySelectorAll('input[name="iceYn"]').forEach(e=>{e.addEventListener("change",n)}),n();const l=document.querySelectorAll('input[name="cupYn"]'),o=document.getElementById("items-container"),i=document.getElementById("cup-ice-selection-box"),p=document.getElementById("ice-water-time-box");l.forEach(e=>{e.addEventListener("change",()=>{s(),n()})}),s()}function h(n){return new URLSearchParams(window.location.search).get(n)}async function P(n){const s=n.target,m=document.getElementById("logoPreview"),l=document.getElementById("fileName");if(!l){window.showToast("에러발생",3e3,"error");return}try{const{base64:o,fileName:i}=await H(s,m,l);g=o,w=i}catch(o){window.showToast(`이미지 업로드 실패: ${o}`,3e3,"warning"),console.warn("이미지 업로드 실패:",o)}}function A(n){var f,B,E,S;const s=Number(h("menuId")||"0"),m=Number(document.getElementById("menu-no").value),l=document.getElementById("menu-name").value,o=document.getElementById("menu-price").value.trim(),i=document.getElementById("menu-category").value,p=((f=document.querySelector('input[name="cupYn"]:checked'))==null?void 0:f.value)||"no",e=((B=document.querySelector('input[name="cup"]:checked'))==null?void 0:B.value)||"",u=((E=document.querySelector('input[name="iceYn"]:checked'))==null?void 0:E.value)||"",t=((S=document.querySelector('input[name="empty"]:checked'))==null?void 0:S.value)||"",a=document.getElementById("ice-time").value.trim(),c=document.getElementById("water-time").value.trim(),r="",D={best:document.getElementById("state-best").value,event:document.getElementById("state-event").value,new:document.getElementById("state-new").value},R=Array.from(document.querySelectorAll(".item")).map((k,U)=>{var q,T,Y,F,x;const b=((q=k.querySelector(".item-type-select"))==null?void 0:q.value)||"",y=k.querySelectorAll("input"),L=String(parseFloat(((T=y[0])==null?void 0:T.value)||"0")),V=String(parseFloat(((Y=y[1])==null?void 0:Y.value)||"0")),_=String(parseFloat(((F=y[2])==null?void 0:F.value)||"0")),M=b==="garucha"?"0":String(parseFloat(((x=y[3])==null?void 0:x.value)||"0"));return{no:String(U+1),type:b,value1:L,value2:V,value3:_,value4:M}});return{userId:n,menuId:s,no:m,name:l,price:o,category:i,cupYn:p,cup:e,empty:t,iceYn:u,iceTime:a,waterTime:c,image:r,state:D,items:R}}}export{X as initProductDetail};
