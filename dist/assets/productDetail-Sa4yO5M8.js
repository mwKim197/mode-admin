import{r as M,v as Y,a as A,h as R}from"./imageUploader-DNMVuul9.js";import{g as q}from"./main-Bf-UK50S.js";import{a as j,c as x,d as G}from"./apiHelpers-DHI6Lj2I.js";let v,I;async function K(){const e=F("menuId");if(!e)return;const t=q();if(!t){window.showToast("사용자 정보가 없습니다.",3e3,"warning");return}const o=await(await j(`/model_admin_menu?userId=${t.userId}&menuId=${e}&func=get-menu-by-id`)).json();await M(o),document.getElementById("logoUpload").addEventListener("change",async r=>{await O(r)});const c=document.getElementById("saveDtlBtn");c&&c.addEventListener("click",async()=>{const r=V(t.userId),m=Y(r);if(m){window.showToast(m,3e3,"warning");return}const l=A(r);if(l){window.showToast(l,3e3,"warning");return}const w={...r,...v&&I&&{originalFileName:I,imageBase64:v}};if(confirm("수정사항을 저장하시겠습니까?")){const g={userId:t.userId,updatedData:w};try{const s=await x("/model_admin_menu?func=put-update-menu",g);if(console.log("res: ",s),s.ok)window.showToast("수정사항 저장완료.");else{window.showToast("수정사항 저장에 실패하였습니다.",3e3,"error");return}}catch{}}});const i=document.getElementById("btnPlasticCup");i&&i.addEventListener("click",()=>{confirm("플라스틱 컵을 배출하시겠습니까?")&&y("pl")});const u=document.getElementById("btnPaperCup");u&&u.addEventListener("click",()=>{confirm("종이컵을 배출하시겠습니까?")&&y("pa")});const d=document.getElementById("btnDrinkOrder");d&&d.addEventListener("click",()=>{confirm("현재 설정으로 음료를 투출하시겠습니까?")&&y("drink",o)})}async function y(e,t={}){const a=q();if(!a){window.showToast("❌ 사용자 정보가 없습니다.",3e3,"error");return}const o={func:e,userId:a.userId,...e==="order"?{orderData:{recipe:t}}:{}};G("/model_machine_controll",o).then(()=>{console.log(`✅ ${e} 명령 전송 완료`),window.showToast(`${e} 명령 전송 완료`)}).catch(n=>{console.error(`❌ ${e} 명령 전송 실패:`,n),window.showToast(`❌ ${e} 명령 전송 실패: ${n} `,3e3,"error")}),window.showToast(`${e} 명령 전송`)}function F(e){return new URLSearchParams(window.location.search).get(e)}async function O(e){const t=e.target,a=document.getElementById("logoPreview"),o=document.getElementById("fileName");if(!o){window.showToast("에러발생",3e3,"error");return}try{const{base64:n,fileName:c}=await R(t,a,o);v=n,I=c}catch(n){window.showToast(`이미지 업로드 실패: ${n}`,3e3,"warning"),console.warn("이미지 업로드 실패:",n)}}function V(e){var h,f,B,E;const t=Number(F("menuId")||"0"),a=Number(document.getElementById("menu-no").value),o=document.getElementById("menu-name").value,n=document.getElementById("menu-price").value.trim(),c=document.getElementById("menu-category").value,i=((h=document.querySelector('input[name="cupYn"]:checked'))==null?void 0:h.value)||"no",u=((f=document.querySelector('input[name="cup"]:checked'))==null?void 0:f.value)||"",d=((B=document.querySelector('input[name="iceYn"]:checked'))==null?void 0:B.value)||"",r=((E=document.querySelector('input[name="empty"]:checked'))==null?void 0:E.value)||"",m=document.getElementById("ice-time").value.trim(),l=document.getElementById("water-time").value.trim(),w="",g={best:document.getElementById("state-best").value,event:document.getElementById("state-event").value,new:document.getElementById("state-new").value},s=Array.from(document.querySelectorAll(".item")).map((S,N)=>{var k,b,P,D,$;const T=((k=S.querySelector(".item-type-select"))==null?void 0:k.value)||"",p=S.querySelectorAll("input"),L=String(parseFloat(((b=p[0])==null?void 0:b.value)||"0")),U=String(parseFloat(((P=p[1])==null?void 0:P.value)||"0")),_=String(parseFloat(((D=p[2])==null?void 0:D.value)||"0")),C=T==="garucha"?"0":String(parseFloat((($=p[3])==null?void 0:$.value)||"0"));return{no:String(N+1),type:T,value1:L,value2:U,value3:_,value4:C}});return{userId:e,menuId:t,no:a,name:o,price:n,category:c,cupYn:i,cup:u,empty:r,iceYn:d,iceTime:m,waterTime:l,image:w,state:g,items:s}}export{K as initProductDetail};
