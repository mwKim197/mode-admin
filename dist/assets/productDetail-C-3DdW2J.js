import{r as A,v as L,a as M,h as R}from"./imageUploader-CKU5pWxX.js";import{g as $,a as j,d as x}from"./main-DOk1qqnK.js";let p,w;async function H(){const t=q("menuId");if(!t)return;const e=$();if(!e){window.showToast("사용자 정보가 없습니다.",3e3,"warning");return}const o=await(await j(`/model_admin_menu?userId=${e.userId}&menuId=${t}&func=get-menu-by-id`)).json();await A(o),document.getElementById("logoUpload").addEventListener("change",async a=>{await C(a)});const u=document.getElementById("saveDtlBtn");u&&u.addEventListener("click",async()=>{const a=G(e.userId),r=L(a);if(r){window.showToast(r,3e3,"warning");return}const s=M(a);if(s){window.showToast(s,3e3,"warning");return}const i={...a,...p&&w&&{originalFileName:w,imageBase64:p}};if(confirm("수정사항을 저장하시겠습니까?")){const l={userId:e.userId,updatedData:i};try{if((await x("/model_admin_menu?func=put-update-menu",l)).ok)window.showToast("수정사항 저장완료."),setTimeout(()=>{window.location.href="/html/product.html"},1e3);else{window.showToast("수정사항 저장에 실패하였습니다.",3e3,"error");return}}catch{}}})}function q(t){return new URLSearchParams(window.location.search).get(t)}async function C(t){const e=t.target,c=document.getElementById("logoPreview"),o=document.getElementById("fileName");if(!o){window.showToast("에러발생",3e3,"error");return}try{const{base64:n,fileName:u}=await R(e,c,o);p=n,w=u}catch(n){window.showToast(`이미지 업로드 실패: ${n}`,3e3,"warning"),console.warn("이미지 업로드 실패:",n)}}function G(t){var g,y,v,I;const e=Number(q("menuId")||"0"),c=Number(document.getElementById("menu-no").value),o=document.getElementById("menu-name").value,n=document.getElementById("menu-price").value.trim(),u=document.getElementById("menu-category").value,a=((g=document.querySelector('input[name="cupYn"]:checked'))==null?void 0:g.value)||"no",r=((y=document.querySelector('input[name="cup"]:checked'))==null?void 0:y.value)||"",s=((v=document.querySelector('input[name="iceYn"]:checked'))==null?void 0:v.value)||"",i=((I=document.querySelector('input[name="empty"]:checked'))==null?void 0:I.value)||"",l=document.getElementById("ice-time").value.trim(),d=document.getElementById("water-time").value.trim(),F="",N={best:document.getElementById("state-best").value,event:document.getElementById("state-event").value,new:document.getElementById("state-new").value},P=Array.from(document.querySelectorAll(".item")).map((h,b)=>{var B,E,S,T,k;const f=((B=h.querySelector(".item-type-select"))==null?void 0:B.value)||"",m=h.querySelectorAll("input"),D=String(parseFloat(((E=m[0])==null?void 0:E.value)||"0")),U=String(parseFloat(((S=m[1])==null?void 0:S.value)||"0")),Y=String(parseFloat(((T=m[2])==null?void 0:T.value)||"0")),_=f==="garucha"?"0":String(parseFloat(((k=m[3])==null?void 0:k.value)||"0"));return{no:String(b+1),type:f,value1:D,value2:U,value3:Y,value4:_}});return{userId:t,menuId:e,no:c,name:o,price:n,category:u,cupYn:a,cup:r,empty:i,iceYn:s,iceTime:l,waterTime:d,image:F,state:N,items:P}}export{H as initProductDetail};
