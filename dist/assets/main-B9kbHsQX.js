const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./productDetail-Cfo90-pu.js","./imageUploader-BHq8Bjd8.js","./productAdd-BsfRMi8W.js","./notice-DGT9ambA.js","./notice-vODWoD1S.css"])))=>i.map(i=>d[i]);
(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))l(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&l(a)}).observe(document,{childList:!0,subtree:!0});function s(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerPolicy&&(r.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?r.credentials="include":o.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function l(o){if(o.ep)return;o.ep=!0;const r=s(o);fetch(o.href,r)}})();const L="modulepreload",T=function(e,n){return new URL(e,n).href},_={},m=function(n,s,l){let o=Promise.resolve();if(s&&s.length>0){let a=function(c){return Promise.all(c.map(u=>Promise.resolve(u).then(p=>({status:"fulfilled",value:p}),p=>({status:"rejected",reason:p}))))};const i=document.getElementsByTagName("link"),t=document.querySelector("meta[property=csp-nonce]"),d=(t==null?void 0:t.nonce)||(t==null?void 0:t.getAttribute("nonce"));o=a(s.map(c=>{if(c=T(c,l),c in _)return;_[c]=!0;const u=c.endsWith(".css"),p=u?'[rel="stylesheet"]':"";if(!!l)for(let g=i.length-1;g>=0;g--){const y=i[g];if(y.href===c&&(!u||y.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${c}"]${p}`))return;const h=document.createElement("link");if(h.rel=u?"stylesheet":L,u||(h.as="script"),h.crossOrigin="",h.href=c,d&&h.setAttribute("nonce",d),document.head.appendChild(h),u)return new Promise((g,y)=>{h.addEventListener("load",g),h.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${c}`)))})}))}function r(a){const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=a,window.dispatchEvent(i),!i.defaultPrevented)throw a}return o.then(a=>{for(const i of a||[])i.status==="rejected"&&r(i.reason);return n().catch(r)})},P="https://api.narrowroad-model.com";async function f(e,n={},s=!0){if(window.location.pathname.includes("/html/log.html")||window.location.pathname==="/")return{ok:!1,status:200,json:async()=>({message:"ë¡œê·¸ì¸ í˜ì´ì§€ì—ì„œëŠ” ì¸ì¦ ìš”ì²­ì„ í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤."})};const o=localStorage.getItem("accessToken");if(!o)return console.log("âŒ í† í°ì´ ì—†ìŠµë‹ˆë‹¤. ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ì´ë™í•©ë‹ˆë‹¤."),window.location.href="/html/log.html",{ok:!1,status:401,json:async()=>({message:"ì¸ì¦ í† í°ì´ ì—†ìŠµë‹ˆë‹¤."})};const r={...n,headers:{...n.headers,Authorization:`Bearer ${o}`,"Content-Type":"application/json"}};s&&window.showLoading();try{const a=await fetch(`${P}${e}`,r);if(a.status===401||a.status===403){const i=await a.json();return console.error("âŒ ì¸ì¦ ì‹¤íŒ¨:",i.message),alert(i.message||"ì„¸ì…˜ì´ ë§Œë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ë¡œê·¸ì¸í•´ì£¼ì„¸ìš”."),localStorage.removeItem("accessToken"),window.location.href="/html/log.html",{ok:!1,status:a.status,json:async()=>i}}return a}catch(a){return console.error("âŒ API ìš”ì²­ ì˜¤ë¥˜:",a),{ok:!1,status:500,json:async()=>({message:"âŒ API ìš”ì²­ ì˜¤ë¥˜"})}}finally{s&&window.hideLoading()}}function S(e,n={}){return f(e,n,!1)}class I extends Error{}I.prototype.name="InvalidTokenError";async function k(){const e=await f("/model_admin_login?func=me");if(e.status===401||e.status===403){console.warn("ğŸš« ì¸ì¦ ì‹¤íŒ¨ - ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ì´ë™"),localStorage.removeItem("accessToken"),window.location.href="/html/log.html";return}const n=await e.json(),s=n==null?void 0:n.grade;if(!s){console.warn("âŒ ì‚¬ìš©ì grade ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.");return}const l={"/html/01.notice.html":[1,2],"/html/01.notice-edit.html":[1,2],"/html/notice.html":[1,2]},o={1:"/html/dashboard.html",2:"/html/dashboard.html",3:"/html/franchise_dashboard.html",4:"/html/store_dashboard.html"},r=window.location.pathname,a=l[r];a&&!a.includes(s)&&(alert("ì´ í˜ì´ì§€ì— ì ‘ê·¼í•  ìˆ˜ ìˆëŠ” ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤."),window.location.href=o[s]||"/html/log.html")}async function O(){const e=await f("/model_admin_login?func=me");if(!e.ok)return console.warn("âŒ ì‚¬ìš©ì ì •ë³´ë¥¼ ê°€ì ¸ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤."),null;const n=await e.json();return{adminId:n.adminId,name:n.name,grade:n.grade}}async function A(){const n=await(await fetch("/partials/head.html")).text();document.head.innerHTML+=n;const l=await(await fetch("/partials/layout.html")).text(),o=document.createElement("div");o.innerHTML=l,document.body.prepend(o);const a=await(await fetch("/partials/header.html")).text(),i=document.createElement("div");if(i.innerHTML=a,document.body.prepend(i),window.location.pathname!=="/html/log.html"){const d=document.createElement("script");d.src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js",d.onload=()=>{const c=document.createElement("script");c.src="/js/common.js",document.body.appendChild(c)},document.head.appendChild(d)}}const x="userInfo";function E(){const e=localStorage.getItem(x);return e?JSON.parse(e):null}const B=async e=>await f(e,{method:"DELETE"}),D=async e=>await f(e,{method:"GET"}),H=async(e,n)=>await f(e,{method:"POST",body:JSON.stringify(n)}),U=async(e,n)=>await f(e,{method:"PUT",body:JSON.stringify(n)});function R(){console.log("ğŸ“Œ initDeviceManage í˜¸ì¶œë¨")}async function b(e,n,s){const l=await D(`/model_machine_registry?func=get-machine-status&userId=${e}`),{availableUrl:o,isOnline:r}=await l.json();r&&o?(w("âœ… "+s),S("/model_machine_controll",{method:"POST",body:JSON.stringify({...n,userId:e})}).then(a=>{a.ok||console.warn("âŒ ë¨¸ì‹  ëª…ë ¹ ì‹¤íŒ¨",a.status)}).catch(a=>{console.error("âŒ ë¨¸ì‹  í†µì‹  ì˜¤ë¥˜",a)})):w("âŒ ë¨¸ì‹ ì´ ì˜¤í”„ë¼ì¸ì…ë‹ˆë‹¤.",4e3,"error")}const j=Object.freeze(Object.defineProperty({__proto__:null,initDeviceManage:R,sendMachineCommand:b},Symbol.toStringTag,{value:"Module"}));window.sendMachineCommand=b;function M(){const e=document.getElementById("global-loading");e&&(e.style.display="flex")}function C(){const e=document.getElementById("global-loading");e&&(e.style.display="none")}window.showLoading=M;window.hideLoading=C;function w(e,n=3e3,s="success"){const l="toast-container";let o=document.getElementById(l);o||(o=document.createElement("div"),o.id=l,o.style.cssText=`
          position: fixed;
          top: 1rem;
          right: 2rem; /* âœ… ì˜¤ë¥¸ìª½ ì—¬ë°±ì€ ê³ ì • */
          z-index: 9999;
          display: flex;
          flex-direction: column;
          align-items: center; /* âœ… ì˜¤ë¥¸ìª½ ì •ë ¬ */
        `,document.body.appendChild(o));const r=document.createElement("div");r.textContent=e;const i={success:{background:"#e6fbe6",border:"2px solid #4CAF50",color:"#2e7d32"},error:{background:"#fde8e8",border:"2px solid #f44336",color:"#b71c1c"},warning:{background:"#fff8e1",border:"2px solid #ffb300",color:"#795548"}}[s];r.style.cssText=`
    background: ${i.background};
    color: ${i.color};
    border: ${i.border};
    padding: 0.8rem 1.2rem;
    margin-top: 0.5rem;
    border-radius: 0.5rem;
    font-size: 1.2rem;
    max-width: 320px;                /* âœ… ìµœëŒ€ ë„ˆë¹„ ì œí•œ */
    white-space: normal;             /* âœ… ì¤„ë°”ê¿ˆ í—ˆìš© */
    word-break: break-word;          /* âœ… ë‹¨ì–´ ê¸¸ì–´ë„ ì¤„ë°”ê¿ˆ */
    box-shadow: 0 2px 8px rgba(0,0,0,0.15);
    transition: all 0.3s ease;
    opacity: 0;
    transform: translateY(-10px);
  `,o.appendChild(r),requestAnimationFrame(()=>{r.style.opacity="1",r.style.transform="translateY(0)"}),setTimeout(()=>{r.style.opacity="0",r.style.transform="translateY(-10px)",setTimeout(()=>o==null?void 0:o.removeChild(r),300)},n)}window.showToast=w;document.addEventListener("DOMContentLoaded",async()=>{console.log("âœ… main.ts ì‹¤í–‰ë¨");const e=window.location.pathname;e!="/html/log.html"&&e!="/html/dashboard.html"&&(localStorage.getItem("authToken")?console.log("âœ… ê¸°ì¡´ ì„¸ì…˜ í† í° ì‚¬ìš©"):(console.log("ğŸ”„ ìë™ë¡œê·¸ì¸ ì‹œë„"),await q()),await k(),await A(),$());const n=await O();if(n){const t=document.getElementById("user-name"),d=document.getElementById("user-grade");if(t&&(t.textContent=`${n.adminId} ë‹˜`),d){const c={1:"ì´ê´„ê´€ë¦¬ì",2:"ìš´ì˜ê´€ë¦¬ì",3:"í”„ëœì°¨ì´ì¦ˆ",4:"ì¼ë°˜íšŒì›"}[n.grade]||"ì¼ë°˜íšŒì›";d.innerHTML=`<span>${c}</span>`,d.classList.remove("manager","franchise","store"),n.grade===1&&d.classList.add("manager"),n.grade===3&&d.classList.add("franchise"),n.grade===4&&d.classList.add("store")}}const s=E();if(s){const t=document.querySelector(".user-menuWrap");t&&(t.style.display="block")}else{const t=document.querySelector(".user-menuWrap");t&&(t.style.display="none")}const l=document.querySelector(".sidemenu .menu"),o=document.createElement("li");if(o.innerHTML='<a href="/html/log.html"><p>ë¡œê·¸ì•„ì›ƒ</p></a>',l==null||l.appendChild(o),!(s!=null&&s.payType)){const t=document.querySelector(".sidemenu .menu");[{href:"/html/point.html",label:"í¬ì¸íŠ¸"}].forEach(c=>{const u=document.createElement("li");u.innerHTML=`<a href="${c.href}"><p>${c.label}</p></a>`,t==null||t.appendChild(u)})}if(n&&n.grade<=2){const t=document.querySelector(".sidemenu .menu");[{href:"/html/notice.html?type=admin",label:"ê´€ë¦¬ì ê³µì§€ì‚¬í•­"},{href:"/html/notice.html?type=notice",label:"í™ˆí˜ì´ì§€ ê³µì§€ì‚¬í•­"},{href:"/html/notice.html?type=store",label:"ì„¤ì¹˜ë§¤ì¥"},{href:"/html/notice.html?type=news",label:"ì–¸ë¡ ë³´ë„"},{href:"/html/notice.html?type=machine",label:"ë¨¸ì‹ ì‚¬ìš©ì„¤ëª…"},{href:"/html/empowerment.html",label:"ê¶Œí•œ ê´€ë¦¬"}].forEach(c=>{const u=document.createElement("li");u.innerHTML=`<a href="${c.href}"><p>${c.label}</p></a>`,t==null||t.appendChild(u)})}e==="/index.html"||e==="/"?console.log("index í˜ì´ì§€"):e==="/html/log.html"?(console.log("ğŸ“Œ ë¡œê·¸ì¸ í˜ì´ì§€ - login.ts ë¡œë“œ"),m(()=>import("./login-D4a44DZm.js"),[],import.meta.url).then(t=>{t.initLogin()})):e==="/html/home.html"?(console.log("ğŸ“Œ í™ˆ í˜ì´ì§€ - home.ts ë¡œë“œ"),m(()=>import("./home-DIRv7svl.js"),[],import.meta.url).then(t=>{t.initHome()})):e==="/html/point.html"?(console.log("ğŸ“Œ í¬ì¸íŠ¸ - point.ts ë¡œë“œ"),m(()=>import("./point-Dtu6uivX.js"),[],import.meta.url).then(t=>{t.initPoint()})):e==="/html/product.html"?(console.log("ğŸ“Œ ìƒí’ˆ - product.ts ë¡œë“œ"),m(()=>import("./product-DSCHk2Sk.js"),[],import.meta.url).then(t=>{t.initProduct()})):e==="/html/product-detail.html"?(console.log("ğŸ“Œ ìƒí’ˆìƒì„¸ - productDetail.ts ë¡œë“œ"),m(()=>import("./productDetail-Cfo90-pu.js"),__vite__mapDeps([0,1]),import.meta.url).then(t=>{t.initProductDetail()})):e==="/html/product-add.html"?(console.log("ğŸ“Œ ìƒí’ˆë“±ë¡ - productAdd.ts ë¡œë“œ"),m(()=>import("./productAdd-BsfRMi8W.js"),__vite__mapDeps([2,1]),import.meta.url).then(t=>{t.initProductAdd()})):e==="/html/register.html"?(console.log("ğŸ“Œ íšŒì›ê°€ì… í˜ì´ì§€ - register.ts ë¡œë“œ"),m(()=>import("./register-D9bIKrXY.js"),[],import.meta.url).then(t=>{t.initRegister()})):e==="/html/notice.html"?(console.log("ğŸ“Œ ê´€ë¦¬ì ê³µì§€ì‚¬í•­ë“±ë¡ - notice.ts ë¡œë“œ"),m(()=>import("./notice-DGT9ambA.js"),__vite__mapDeps([3,4]),import.meta.url).then(t=>{t.initNotice()})):e==="/html/franchise_dashboard.html"?(console.log("ğŸ˜ï¸ í”„ëœì°¨ì´ì¦ˆ - franchise.ts ë¡œë“œ"),m(()=>import("./franchise-BqQbRFTF.js"),[],import.meta.url).then(t=>{t.franchiseEdit()})):e==="/html/store_dashboard.html"?(console.log("ğŸ“Œ ë°ì‰¬ë³´ë“œ - store_dashboard.ts ë¡œë“œ"),m(()=>import("./store-p9FV3yAN.js"),[],import.meta.url).then(t=>{t.storeEdit()})):e==="/html/deviceManage.html"?(console.log("ğŸ“Œ ë¨¸ì‹ ê´€ë¦¬ - deviceManage.ts ë¡œë“œ"),m(()=>Promise.resolve().then(()=>j),void 0,import.meta.url).then(t=>{t.initDeviceManage()})):e==="/html/sales.html"?(console.log("ğŸ“Œ ë§¤ì¶œ - sales.ts ë¡œë“œ"),m(()=>import("./sales-DiS-wI3Z.js"),[],import.meta.url).then(t=>{t.initSales()})):e==="/html/normalSet.html"?(console.log("ğŸ“Œ ì¼ë°˜ì„¤ì • - normalSet.ts ë¡œë“œ"),m(()=>import("./normalSet-Bmla3OG6.js"),[],import.meta.url).then(t=>{t.initNormalSet()})):e==="/html/couponList.html"?(console.log("ğŸ“Œ ì¿ í°ëª©ë¡ - couponList.ts ë¡œë“œ"),m(()=>import("./couponList-Bd7YIHu4.js"),[],import.meta.url).then(t=>{t.initCouponList()})):console.log("ğŸ“Œ ê¸°ë³¸ í˜ì´ì§€");const r=document.querySelector(".user-menuWrap"),a=document.querySelector(".user-setBox"),i=r==null?void 0:r.querySelector(".ani-1");r&&a&&i&&(i.addEventListener("click",t=>{t.stopPropagation(),a.classList.contains("hidden")&&a.classList.remove("hidden")}),a.addEventListener("click",t=>{t.stopPropagation()}),document.addEventListener("click",t=>{a.classList.contains("hidden")||!a.contains(t.target)&&!t.target.closest(".ani-1")&&a.classList.add("hidden")},!1))});window.addEventListener("load",()=>{document.body.style.visibility="visible"});function $(){const e=E();if(!e){console.warn("âŒ ì‚¬ìš©ì ì •ë³´ ì—†ìŒ");return}const n=e.userId;document.querySelectorAll("a[data-func], button[data-func]").forEach(s=>{s.addEventListener("click",l=>{l.preventDefault();const o=s.dataset.func,r=s.dataset.msg||"ëª…ë ¹ì´ ì „ì†¡ë˜ì—ˆìŠµë‹ˆë‹¤";if(o==="wash"||o==="pl"||o==="pa"||o==="restart"||o==="shutdown"){let i="";if(o==="wash"&&(i="ê¸°ê¸°ì„¸ì²™ì„ ì§„í–‰í•˜ì‹œê² ìŠµë‹ˆê¹Œ?"),o==="pl"&&(i="í”Œë¼ìŠ¤í‹±ì»µì„ ë°°ì¶œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?"),o==="pa"&&(i="ì¢…ì´ì»µì„ ë°°ì¶œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?"),o==="restart"&&(i="í”„ë¡œê·¸ë¨ì„ ì¬ì‹œì‘í•˜ì‹œê² ìŠµë‹ˆê¹Œ?"),o==="shutdown"&&(i="í”„ë¡œê·¸ë¨ì„ ì¢…ë£Œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?"),!confirm(i))return}const a=s.id==="coffeeWash"?{data:[{type:"coffee"}]}:s.id==="wash"?{data:[{type:"coffee"},{type:"garucha",value1:"1"},{type:"garucha",value1:"2"},{type:"garucha",value1:"3"},{type:"garucha",value1:"4"},{type:"garucha",value1:"5"},{type:"garucha",value1:"6"},{type:"syrup",value1:"1"},{type:"syrup",value1:"2"},{type:"syrup",value1:"3"},{type:"syrup",value1:"5"},{type:"syrup",value1:"6"}]}:void 0;window.sendMachineCommand(n,a?{func:o,washData:a}:{func:o},r)})}),document.querySelectorAll("a[data-type][data-value], button[data-type][data-value]").forEach(s=>{s.addEventListener("click",l=>{l.preventDefault();const o=s.dataset.type,r=s.dataset.value;let a=r;o==="syrup"&&(parseFloat(r)===5?a=String(4):parseFloat(r)===6&&(a=String(5)));const i=`${o==="garucha"?"ê°€ë£¨ì°¨":"ì‹œëŸ½"} ${a}ë²ˆ ì„¸ì²™`,t={data:[{type:o,value1:r}]};window.sendMachineCommand(n,{func:"wash",washData:t},i)})})}async function q(){const e="https://api.narrowroad-model.com",n=localStorage.getItem("refreshToken");if(!n){console.log("ğŸ”’ ìë™ë¡œê·¸ì¸ ìŠ¤í‚µ: refreshToken ì—†ìŒ");return}console.log("ğŸ”„ ìë™ë¡œê·¸ì¸ ì‹œë„ ì¤‘...");try{const s=await fetch(`${e}/model_admin_login?func=refresh`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refreshToken:n})}),l=await s.json();console.log(l),s.ok?(localStorage.setItem("accessToken",l.accessToken),console.log("âœ… ìë™ë¡œê·¸ì¸ ì„±ê³µ")):(console.warn("âŒ ìë™ë¡œê·¸ì¸ ì‹¤íŒ¨:",l.message||"Unknown error"),localStorage.removeItem("refreshToken"),v())}catch(s){console.error("âŒ ìë™ë¡œê·¸ì¸ ìš”ì²­ ì˜¤ë¥˜:",s),v()}}function v(){console.log("â¡ï¸ ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ì´ë™"),window.location.href="/html/log.html"}export{D as a,B as b,O as c,U as d,H as e,f,E as g};
