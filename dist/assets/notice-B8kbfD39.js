import{f}from"./main-Dt6ep3wI.js";import{a as s}from"./common-Dj9lc78O.js";function p(){var d;console.log("✅ notice.ts 로드됨"),(d=document.getElementById("dashboard-button"))==null||d.addEventListener("click",()=>{location.href="/html/dashboard.html"});const o=document.getElementById("notice-list");if(!o){console.error("❌ 필수 요소가 없습니다.");return}function l(t){return new URLSearchParams(window.location.search).get(t)}const a=l("type")||"notice",i=document.getElementById("page-title");if(i){let t="";switch(a){case"notice":t="공지사항 목록";break;case"store":t="설치 매장 목록";break;case"news":t="언론 보도 목록";break;case"machine":t="머신 설명서 목록";break;default:t="게시글 작성"}i.textContent=t}function m(t){o!==null&&(o.innerHTML="",t.forEach(e=>{const n=document.createElement("div");n.className="p-4 border rounded mb-2 hover:bg-gray-100 flex justify-between items-center",n.setAttribute("data-id",e.contentId);const r=new Date(e.timestamp).toLocaleDateString("ko-KR");n.innerHTML=`
        <div>
          <div class="font-bold">${e.title}</div>
          <div class="text-sm text-gray-500">${r} / 작성자: ${e.adminId}</div>
        </div>
        <div class="flex space-x-2">
            <button class="edit-btn text-blue-600 underline" data-id="${e.contentId}">수정</button>
            <button class="delete-btn text-red-600 underline" data-id="${e.contentId}">삭제</button>
        </div>
      `,o.appendChild(n)}))}async function c(){try{const e=await(await fetch(`https://api.narrowroad-model.com/model_home_page?func=get-posts&contentType=${a}`)).json();m(e),u()}catch(t){console.error("❌ 공지사항 불러오기 실패",t)}}function u(){s(".edit-btn",async t=>{t.stopPropagation();const e=t.target.getAttribute("data-id");e&&(location.href=`/html/notice-edit.html?type=${a}&id=${e}`)}),s(".delete-btn",async t=>{t.stopPropagation();const e=t.target.getAttribute("data-id");if(!(!e||!confirm("정말 삭제하시겠습니까?")))try{(await f(`/model_home_page?func=delete-post&contentType=${a}&contentId=${e}`,{method:"DELETE"})).ok?(alert("삭제 완료"),await c()):alert("삭제 실패")}catch(r){console.error("❌ 삭제 요청 실패",r)}})}c()}export{p as initNotice};
