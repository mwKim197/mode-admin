import{r as U,h as P,v as V,a as L}from"./imageUploader-kdRwhlyg.js";import{g as M,e as C}from"./main-BuK2NTGw.js";let g,w;async function j(){const a=document.querySelector(".back-box");a&&(a.style.display="flex");const l=M();if(!l){window.showToast("사용자 정보가 없습니다.",3e3,"error");return}await U(null),document.getElementById("logoUpload").addEventListener("change",async n=>{await R(n)});const o=document.getElementById("saveDtlBtn");if(o){let n=function(){var e;const t=(e=document.querySelector('input[name="iceYn"]:checked'))==null?void 0:e.value;i&&(i.style.display=t==="no"?"none":"block")},s=function(){var c;const e=((c=document.querySelector('input[name="cupYn"]:checked'))==null?void 0:c.value)==="yes";d&&(d.style.display=e?"none":"block"),m&&(m.style.display=e?"none":"block"),y&&(y.style.display=e?"none":"block")};o.addEventListener("click",async()=>{const t=_(l.userId);if(!g||!w){window.showToast("이미지 등록은 필수입니다.",3e3,"warning");return}const e=V(t);if(e){window.showToast(e,3e3,"warning");return}const c=L(t);if(c){window.showToast(c,3e3,"warning");return}if(confirm("신규 메뉴를 등록하시겠습니까?")){const f={userId:l.userId,data:t,...g&&w&&{originalFileName:w,imageBase64:g}};try{if(!(await C("/model_admin_menu?func=set-new-menu",f)).ok){window.showToast("신규 메뉴 등록에 실패하였습니다.",3e3,"error");return}window.showToast("신규 메뉴가 등록되었습니다."),setTimeout(()=>{window.location.href="/html/product.html"},1e3)}catch(r){console.error("등록 중 오류 발생:",r),window.showToast("오류가 발생했습니다.",3e3,"error")}}});const i=document.getElementById("ice-water-time-box");n();const v=document.querySelectorAll('input[name="cupYn"]'),d=document.getElementById("items-container"),m=document.getElementById("cup-ice-selection-box"),y=document.getElementById("ice-water-time-box");v.forEach(t=>{t.addEventListener("change",s)}),s()}}async function R(a){const l=a.target,u=document.getElementById("logoPreview"),o=document.getElementById("fileName");if(!o){window.showToast("에러발생",3e3,"error");return}try{const{base64:n,fileName:s}=await P(l,u,o);g=n,w=s}catch(n){window.showToast("이미지 업로드 실패",3e3,"error"),console.warn("이미지 업로드 실패:",n)}}function _(a){var r,I,h,B;const u=Number(document.getElementById("menu-no").value),o=document.getElementById("menu-name").value,n=document.getElementById("menu-price").value.trim(),s=document.getElementById("menu-category").value,i=((r=document.querySelector('input[name="cupYn"]:checked'))==null?void 0:r.value)||"no",v=((I=document.querySelector('input[name="cup"]:checked'))==null?void 0:I.value)||"",d=((h=document.querySelector('input[name="iceYn"]:checked'))==null?void 0:h.value)||"",m=((B=document.querySelector('input[name="empty"]:checked'))==null?void 0:B.value)||"",y=document.getElementById("ice-time").value.trim(),t=document.getElementById("water-time").value.trim(),e="",c={best:document.getElementById("state-best").value,event:document.getElementById("state-event").value,new:document.getElementById("state-new").value},f=Array.from(document.querySelectorAll(".item")).map((E,F)=>{var k,T,b,q,x;const S=((k=E.querySelector(".item-type-select"))==null?void 0:k.value)||"",p=E.querySelectorAll("input"),Y=String(parseFloat(((T=p[0])==null?void 0:T.value)||"0")),N=String(parseFloat(((b=p[1])==null?void 0:b.value)||"0")),A=String(parseFloat(((q=p[2])==null?void 0:q.value)||"0")),D=S==="garucha"?"0":String(parseFloat(((x=p[3])==null?void 0:x.value)||"0"));return{no:String(F+1),type:S,value1:Y,value2:N,value3:A,value4:D}});return{userId:a,menuId:0,no:u,name:o,price:n,category:s,cupYn:i,cup:v,empty:m,iceYn:d,iceTime:y,waterTime:t,image:e,state:c,items:f}}export{j as initProductAdd};
