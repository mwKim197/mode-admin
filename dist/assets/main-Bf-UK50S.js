const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./home-BHVl1q4A.js","./apiHelpers-DHI6Lj2I.js","./point-CaQbh6gk.js","./product-CrhK4XIr.js","./productDetail-Sa4yO5M8.js","./imageUploader-DNMVuul9.js","./productAdd-BJRmE8_y.js","./notice-CSZR3e2N.js","./notice-vODWoD1S.css","./deviceManage-CibvOWWh.js","./sales-DaAUO92N.js","./normalSet-DzqAbre6.js"])))=>i.map(i=>d[i]);
(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))e(o);new MutationObserver(o=>{for(const n of o)if(n.type==="childList")for(const s of n.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&e(s)}).observe(document,{childList:!0,subtree:!0});function a(o){const n={};return o.integrity&&(n.integrity=o.integrity),o.referrerPolicy&&(n.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?n.credentials="include":o.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function e(o){if(o.ep)return;o.ep=!0;const n=a(o);fetch(o.href,n)}})();const w="modulepreload",E=function(t,r){return new URL(t,r).href},_={},c=function(r,a,e){let o=Promise.resolve();if(a&&a.length>0){let s=function(l){return Promise.all(l.map(h=>Promise.resolve(h).then(f=>({status:"fulfilled",value:f}),f=>({status:"rejected",reason:f}))))};const i=document.getElementsByTagName("link"),m=document.querySelector("meta[property=csp-nonce]"),u=(m==null?void 0:m.nonce)||(m==null?void 0:m.getAttribute("nonce"));o=s(a.map(l=>{if(l=E(l,e),l in _)return;_[l]=!0;const h=l.endsWith(".css"),f=h?'[rel="stylesheet"]':"";if(!!e)for(let p=i.length-1;p>=0;p--){const g=i[p];if(g.href===l&&(!h||g.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${l}"]${f}`))return;const d=document.createElement("link");if(d.rel=h?"stylesheet":w,h||(d.as="script"),d.crossOrigin="",d.href=l,u&&d.setAttribute("nonce",u),document.head.appendChild(d),h)return new Promise((p,g)=>{d.addEventListener("load",p),d.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${l}`)))})}))}function n(s){const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=s,window.dispatchEvent(i),!i.defaultPrevented)throw s}return o.then(s=>{for(const i of s||[])i.status==="rejected"&&n(i.reason);return r().catch(n)})},b="https://api.narrowroad-model.com";async function y(t,r={},a=!0){if(window.location.pathname.includes("/html/log.html")||window.location.pathname==="/")return{ok:!1,status:200,json:async()=>({message:"로그인 페이지에서는 인증 요청을 하지 않습니다."})};const o=localStorage.getItem("authToken");if(!o)return console.log("❌ 토큰이 없습니다. 로그인 페이지로 이동합니다."),window.location.href="/index.html",{ok:!1,status:401,json:async()=>({message:"인증 토큰이 없습니다."})};const n={...r,headers:{...r.headers,Authorization:`Bearer ${o}`,"Content-Type":"application/json"}};a&&window.showLoading();try{const s=await fetch(`${b}${t}`,n);if(s.status===401||s.status===403){const i=await s.json();return console.error("❌ 인증 실패:",i.message),alert(i.message||"세션이 만료되었습니다. 다시 로그인해주세요."),localStorage.removeItem("authToken"),window.location.href="/index.html",{ok:!1,status:s.status,json:async()=>i}}return s}catch(s){return console.error("❌ API 요청 오류:",s),{ok:!1,status:500,json:async()=>({message:"❌ API 요청 오류"})}}finally{a&&window.hideLoading()}}function k(t,r={}){return y(t,r,!1)}class v extends Error{}v.prototype.name="InvalidTokenError";async function L(){const t=await y("/model_admin_login?func=me");if(t.status===401||t.status===403){console.warn("🚫 인증 실패 - 로그인 페이지로 이동"),localStorage.removeItem("authToken"),window.location.href="/index.html";return}const r=await t.json();console.log("✅ 사용자 정보:",r);const a=r==null?void 0:r.grade;if(!a){console.warn("❌ 사용자 grade 정보가 없습니다.");return}const e={"/html/01.notice.html":[1,2],"/html/01.notice-edit.html":[1,2],"/html/notice.html":[1,2]},o={1:"/html/dashboard.html",2:"/html/dashboard.html",3:"/html/franchise_dashboard.html",4:"/html/store_dashboard.html"},n=window.location.pathname,s=e[n];s&&!s.includes(a)&&(alert("이 페이지에 접근할 수 있는 권한이 없습니다."),window.location.href=o[a]||"/index.html")}async function I(){const t=await y("/model_admin_login?func=me");if(!t.ok)return console.warn("❌ 사용자 정보를 가져오지 못했습니다."),null;const r=await t.json();return{adminId:r.adminId,name:r.name,grade:r.grade}}async function P(){const r=await(await fetch("/partials/head.html")).text();document.head.innerHTML+=r;const e=await(await fetch("/partials/layout.html")).text(),o=document.createElement("div");o.innerHTML=e,document.body.prepend(o);const s=await(await fetch("/partials/header.html")).text(),i=document.createElement("div");if(i.innerHTML=s,document.body.prepend(i),window.location.pathname!=="/html/log.html"){const u=document.createElement("script");u.src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js",u.onload=()=>{const l=document.createElement("script");l.src="/js/common.js",document.body.appendChild(l)},document.head.appendChild(u)}}const T="userInfo";function x(){const t=localStorage.getItem(T);return t?JSON.parse(t):null}function A(){const t=document.getElementById("global-loading");t&&(t.style.display="flex")}function R(){const t=document.getElementById("global-loading");t&&(t.style.display="none")}window.showLoading=A;window.hideLoading=R;function S(t,r=3e3,a="success"){const e="toast-container";let o=document.getElementById(e);o||(o=document.createElement("div"),o.id=e,o.style.cssText=`
          position: fixed;
          top: 1rem;
          right: 2rem; /* ✅ 오른쪽 여백은 고정 */
          z-index: 9999;
          display: flex;
          flex-direction: column;
          align-items: center; /* ✅ 오른쪽 정렬 */
        `,document.body.appendChild(o));const n=document.createElement("div");n.textContent=t;const i={success:{background:"#e6fbe6",border:"2px solid #4CAF50",color:"#2e7d32"},error:{background:"#fde8e8",border:"2px solid #f44336",color:"#b71c1c"},warning:{background:"#fff8e1",border:"2px solid #ffb300",color:"#795548"}}[a];n.style.cssText=`
    background: ${i.background};
    color: ${i.color};
    border: ${i.border};
    padding: 0.8rem 1.2rem;
    margin-top: 0.5rem;
    border-radius: 0.5rem;
    font-size: 1.2rem;
    max-width: 320px;                /* ✅ 최대 너비 제한 */
    white-space: normal;             /* ✅ 줄바꿈 허용 */
    word-break: break-word;          /* ✅ 단어 길어도 줄바꿈 */
    box-shadow: 0 2px 8px rgba(0,0,0,0.15);
    transition: all 0.3s ease;
    opacity: 0;
    transform: translateY(-10px);
  `,o.appendChild(n),requestAnimationFrame(()=>{n.style.opacity="1",n.style.transform="translateY(0)"}),setTimeout(()=>{n.style.opacity="0",n.style.transform="translateY(-10px)",setTimeout(()=>o==null?void 0:o.removeChild(n),300)},r)}window.showToast=S;document.addEventListener("DOMContentLoaded",async()=>{console.log("✅ main.ts 실행됨");const t=window.location.pathname;t!="/html/log.html"&&t!="/html/dashboard.html"&&(await L(),await P());const r=await I();if(r){const e=document.getElementById("user-name"),o=document.getElementById("user-grade");if(e&&(e.textContent=`${r.adminId} 님`),o){const n={1:"총괄관리자",2:"운영관리자",3:"프랜차이즈",4:"일반회원"}[r.grade]||"일반회원";o.innerHTML=`<span>${n}</span>`,o.classList.remove("manager","franchise","store"),r.grade===1&&o.classList.add("manager"),r.grade===3&&o.classList.add("franchise"),r.grade===4&&o.classList.add("store")}}const a=x();if(a){const e=document.querySelector(".user-menuWrap");e&&(e.style.display="block")}else{const e=document.querySelector(".user-menuWrap");e&&(e.style.display="none")}if(!(a!=null&&a.payType)){const e=document.querySelector(".sidemenu .menu");[{href:"/html/point.html",label:"포인트"}].forEach(n=>{const s=document.createElement("li");s.innerHTML=`<a href="${n.href}"><p>${n.label}</p></a>`,e==null||e.appendChild(s)})}if(r&&r.grade<=2){const e=document.querySelector(".sidemenu .menu");[{href:"/html/notice.html?type=admin",label:"관리자 공지사항"},{href:"/html/notice.html?type=notice",label:"홈페이지 공지사항"},{href:"/html/notice.html?type=store",label:"설치매장"},{href:"/html/notice.html?type=news",label:"언론보도"},{href:"/html/notice.html?type=machine",label:"머신사용설명"},{href:"/html/empowerment.html",label:"권한 관리"}].forEach(n=>{const s=document.createElement("li");s.innerHTML=`<a href="${n.href}"><p>${n.label}</p></a>`,e==null||e.appendChild(s)})}t==="/index.html"||t==="/"?console.log("index 페이지"):t==="/html/log.html"?(console.log("📌 로그인 페이지 - login.ts 로드"),c(()=>import("./login-CF7JtnLB.js"),[],import.meta.url).then(e=>{e.initLogin()})):t==="/html/home.html"?(console.log("📌 홈 페이지 - home.ts 로드"),c(()=>import("./home-BHVl1q4A.js"),__vite__mapDeps([0,1]),import.meta.url).then(e=>{e.initHome()})):t==="/html/point.html"?(console.log("📌 포인트 - point.ts 로드"),c(()=>import("./point-CaQbh6gk.js"),__vite__mapDeps([2,1]),import.meta.url).then(e=>{e.initPoint()})):t==="/html/product.html"?(console.log("📌 상품 - product.ts 로드"),c(()=>import("./product-CrhK4XIr.js"),__vite__mapDeps([3,1]),import.meta.url).then(e=>{e.initProduct()})):t==="/html/product-detail.html"?(console.log("📌 상품상세 - productDetail.ts 로드"),c(()=>import("./productDetail-Sa4yO5M8.js"),__vite__mapDeps([4,5,1]),import.meta.url).then(e=>{e.initProductDetail()})):t==="/html/product-add.html"?(console.log("📌 상품등록 - productAdd.ts 로드"),c(()=>import("./productAdd-BJRmE8_y.js"),__vite__mapDeps([6,5,1]),import.meta.url).then(e=>{e.initProductAdd()})):t==="/html/register.html"?(console.log("📌 회원가입 페이지 - register.ts 로드"),c(()=>import("./register-pgk0P5Wv.js"),[],import.meta.url).then(e=>{e.initRegister()})):t==="/html/notice.html"?(console.log("📌 관리자 공지사항등록 - notice.ts 로드"),c(()=>import("./notice-CSZR3e2N.js"),__vite__mapDeps([7,1,8]),import.meta.url).then(e=>{e.initNotice()})):t==="/html/franchise_dashboard.html"?(console.log("🏘️ 프랜차이즈 - franchise.ts 로드"),c(()=>import("./franchise-BqQbRFTF.js"),[],import.meta.url).then(e=>{e.franchiseEdit()})):t==="/html/store_dashboard.html"?(console.log("📌 데쉬보드 - store_dashboard.ts 로드"),c(()=>import("./store-p9FV3yAN.js"),[],import.meta.url).then(e=>{e.storeEdit()})):t==="/html/deviceManage.html"?(console.log("📌 머신관리 - deviceManage.ts 로드"),c(()=>import("./deviceManage-CibvOWWh.js"),__vite__mapDeps([9,1]),import.meta.url).then(e=>{e.initDeviceManage()})):t==="/html/sales.html"?(console.log("📌 매출 - sales.ts 로드"),c(()=>import("./sales-DaAUO92N.js"),__vite__mapDeps([10,1]),import.meta.url).then(e=>{e.initSales()})):t==="/html/normalSet.html"?(console.log("📌 일반설정 - normalSet.ts 로드"),c(()=>import("./normalSet-DzqAbre6.js"),__vite__mapDeps([11,1]),import.meta.url).then(e=>{e.initNormalSet()})):console.log("📌 기본 페이지")});window.addEventListener("load",()=>{document.body.style.visibility="visible"});export{I as a,k as b,y as f,x as g,S as s};
