<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <link rel="stylesheet" href="/src/css/reset.css" />
  <link rel="stylesheet" href="/src/css/common.css" />
  <link rel="stylesheet" href="/src/css/style.css" />
  <script type="module" src="/src/main.ts"></script>
  <!-- ✅ 메인 진입 -->
</head>

<body>
<!-- 메인 -->
<div id="main-content">
  <!-- 커피봇 -->
  <section class="mt8">
    <div class="inner">
      <div class="user-flex">
        <div class="user">
          <i class="fa-regular fa-circle-user"></i>
          <p id="user-name">-</p>
          <label class="label manager" id="user-grade"
          ><span>-</span></label
          >
        </div>
      </div>
    </div>
  </section>

  <!-- 당월매출 -->
  <section class="pb20">
    <div class="inner">
      <div class="notice-slider-wrapper overflow-hidden">
        <div class="notice-slider" id="noticeSlider">
        </div>
      </div>

      <div class="boxStyle bl" id="noticeBox">
        <div class="countArea">
          <div class="countbox mb10">
            <p>당일 매출</p>
            <h4 data-target="0" id="today">
              <span class="number">0000000</span><small>원</small>
            </h4>
          </div>
          <div class="countbox">
            <p>전일 매출</p>
            <h4 data-target="0" id="yesterday">
              <span class="number">0000000</span><small>원</small>
            </h4>
          </div>
          <hr class="borderSt-dot" />
          <div class="flex">
            <div class="countbox St2">
              <p>당월 매출</p>
              <h4 data-target="0" id="month">
                <span class="number" >0000000</span><small>원</small>
              </h4>
            </div>
            <div class="countbox St2">
              <p>최고 매출</p>
              <h4 data-target="0" id="highest">
                <span class="number">0000000</span><small>원</small>
              </h4>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- 빠른재고 -->
  <section>
    <div class="inner">
      <div class="boxStyle wt">
        <div class="title-flex mb20">
          <h2>빠른재고</h2>
          <button class="btn-outline">전체채우기</button>
        </div>
        <div class="progress-container">
          <div class="protext">가루차1</div>
          <div class="progress-bar">
            <div class="progress-fill fill1">0%</div>
          </div>
          <button class="refresh-btn" onclick="replayAnimation(0)">
            <img src="/img/refresh.svg" alt="" />
          </button>
        </div>

        <div class="progress-container">
          <div class="protext">액상2</div>
          <div class="progress-bar">
            <div class="progress-fill fill2">0%</div>
          </div>
          <button class="refresh-btn" onclick="replayAnimation(1)">
            <img src="/img/refresh.svg" alt="" />
          </button>
        </div>

        <div class="progress-container">
          <div class="protext">액상3</div>
          <div class="progress-bar">
            <div class="progress-fill fill3">0%</div>
          </div>
          <button class="refresh-btn" onclick="replayAnimation(2)">
            <img src="/img/refresh.svg" alt="" />
          </button>
        </div>

        <div class="progress-container">
          <div class="protext">플라스틱컵</div>
          <div class="progress-bar">
            <div class="progress-fill fill4">0%</div>
          </div>
          <button class="refresh-btn" onclick="replayAnimation(3)">
            <img src="/img/refresh.svg" alt="" />
          </button>
        </div>
      </div>
    </div>
  </section>

  <!-- 공지사항 -->
  <section>
    <div class="inner">
      <div class="boxStyle wt mb20">
        <h2 class="ta-c mb20">공지사항</h2>
        <div class="notice-flex">
        </div>
      </div>
    </div>
  </section>
  <div id="popupArea" class="hidden fixed inset-0 z-50"></div>
</div>
</body>

<script>
  const fills = document.querySelectorAll(".progress-fill");
  const buttons = document.querySelectorAll(".refresh-btn");
  const values = Array.from({ length: fills.length }, () => 50); // 초기 50%

  function animateProgress(index, value, changeColor = false) {
    const fill = fills[index];

    // 초기화
    fill.style.transition = "none";
    fill.style.width = "0%";
    fill.textContent = "0%";
    fill.style.backgroundColor = ""; // 색상 초기화

    // 강제 리렌더링
    void fill.offsetWidth;

    // 애니메이션 시작
    fill.style.transition = "width 1s ease";
    fill.style.width = value + "%";

    setTimeout(() => {
      fill.textContent = value + "%";
      if (changeColor) {
        fill.style.backgroundColor = "#2B7FE8"; // 파란색으로
      }
    }, 1000);
  }

  function replayAnimation(index) {
    animateProgress(index, 100, true);
  }

  window.addEventListener("DOMContentLoaded", () => {
    // 초기 렌더링
    values.forEach((val, idx) => {
      animateProgress(idx, val);
    });

    // 각 버튼에 이벤트 연결
    buttons.forEach((btn, index) => {
      btn.addEventListener("click", () => {
        replayAnimation(index);
      });
    });
  });
</script>
</html>
